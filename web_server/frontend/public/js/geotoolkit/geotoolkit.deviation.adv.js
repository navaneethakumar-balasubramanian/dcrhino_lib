/* tslint:disable */
/* eslint-disable */
/**
 * Copyright: Copyright (c) 2016 by INT, Inc.  All rights reserved.<br>
 * Company: INT, Inc. <br>
 * INT PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
 */
(function (root, factory) {
if (root && typeof root['define'] === 'function') {
    root['define']("geotoolkit.deviation", ["geotoolkit.controls","geotoolkit.svg"], function() {
      root._geo = factory(root, root._geo);
      root.geotoolkit = root._geo.geotoolkit || root.geotoolkit;
      return root.geotoolkit;
    });
} else if (typeof module !== 'undefined' && typeof module.exports === 'object') {
    var m = factory(root, root && root._geo);
    module.exports._geo = m;
    if (root) { 
        root._geo = module.exports._geo;
        if(!root.geotoolkit) {
            root.geotoolkit = module.exports._geo.geotoolkit;
        }
    }
    if (!module.exports.geotoolkit) module.exports.geotoolkit=module.exports._geo.geotoolkit;
} else {
    root._geo = factory(root, root._geo);
    root.geotoolkit = root._geo.geotoolkit || root.geotoolkit;
    return root.geotoolkit;
}

}(typeof window !== "undefined" ? window : undefined, function (window, _geo) {
var _geo=_geo||{};_geo.c.hd=_geo.c.hd||{};_geo.c.hd.ia=_geo.c.hd.ia||{};_geo.c.hd.uk={De:"Left",ub:"Center",Pd:"Right"};
_geo.c.hd.gc=function(){function b(a){return 0<=a?Math.floor(a+.5):Math.ceil(a-.5)}function a(){}_geo.c.ja(a,"geotoolkit.deviation.Util");a.dO=function(a){return 0>a?Math.ceil(a):Math.floor(a)};a.Aua=function(a,b){return a.ga()*b.ga()+a.ea()*b.ea()};a.YHc=function(a,b){return a.ga()*b.ea()-a.ea()*b.ga()};a.Mrc=function(a,b,d){var f=(a.ga()-b.ga())*(d.ga()-b.ga())+(a.ea()-b.ea())*(d.ea()-b.ea());a=(a.ga()-b.ga())*(d.ea()-b.ea())-(a.ea()-b.ea())*(d.ga()-b.ga());return 0!==f||0!==a?Math.atan2(a,f):0};
a.Lu=function(a,e,d,f){if(f){if(f=b(e.ga()),e=b(e.ea()),0<Math.abs(d.ga()-f)||0<Math.abs(d.ea()-e))d.lb(f,e),a.push(new _geo.c.f.sa(f,e))}else a.push(e)};a.Pyc=function(a,b,d,f,h){var l=0<=(a.ea()-b.ea())*(d.ga()-b.ga())-(a.ga()-b.ga())*(d.ea()-b.ea());return l!==0<=(a.ea()-d.ea())*(f.ga()-d.ga())-(a.ga()-d.ga())*(f.ea()-d.ea())||l!==0<=(a.ea()-f.ea())*(h.ga()-f.ga())-(a.ga()-f.ga())*(h.ea()-f.ea())||l!==0<=(a.ea()-h.ea())*(b.ga()-h.ga())-(a.ga()-h.ga())*(b.ea()-h.ea())?!1:!0};a.vpb=function(a,b,
d,f,h){var l=(f.ea()-d.ea())*(b.ga()-a.ga())-(f.ga()-d.ga())*(b.ea()-a.ea());return 0!==l?(f=((f.ga()-d.ga())*(a.ea()-d.ea())-(f.ea()-d.ea())*(a.ga()-d.ga()))/l,d=a.ea()+f*(b.ea()-a.ea()),a=a.ga()+f*(b.ga()-a.ga()),h.lb(a,d),!0):!1};a.w4b=function(a,b,d,f){var h=0<=(a.ea()-b.ea())*(d.ga()-b.ga())-(a.ga()-b.ga())*(d.ea()-b.ea());return h!==0<=(a.ea()-d.ea())*(f.ga()-d.ga())-(a.ga()-d.ga())*(f.ea()-d.ea())||h!==0<=(a.ea()-f.ea())*(b.ga()-f.ga())-(a.ga()-f.ga())*(b.ea()-f.ea())?!1:!0};a.ud=function(a){return Math.abs(a.ga())<=
Number.MIN_VALUE?Math.abs(a.ea()):Math.abs(a.ea())<=Number.MIN_VALUE?Math.abs(a.ga()):Math.sqrt(a.ga()*a.ga()+a.ea()*a.ea())};a.K7b=function(a){var b=a?a.length:0;return 2>b?!0:_geo.c.f.sa.Jm(a[0],a[b-1])<_geo.c.f.Math.Hc};a.OL=function(a,b,d){a=a.ea()===b.ea()?(a.ga()+b.ga())/2:a.ga()+(b.ga()-a.ga())*(d-a.ea())/(b.ea()-a.ea());return new _geo.c.f.sa(a,d)};a.v4b=function(a,b,d){var f=_geo.c.f.Math.Hc,h=b.ea()-a.ea();if(0===h)return Math.abs(a.ea()-d.ea())<=f;var l=b.ga()-a.ga();return 0===l?Math.abs(a.ga()-
d.ga())<=f:Math.abs(a.ga()+(b.ga()-a.ga())*(d.ea()-a.ea())/h-d.ga())<=f||Math.abs(a.ea()+(b.ea()-a.ea())*(d.ga()-a.ga())/l-d.ea())<=f?!0:!1};a.GVb=function(a,b,d,f,h,l,k){if(0>=k)throw Error("Invalid radius");var m=Math.atan2(b-f,a-d);h=Math.atan2(l-f,h-d);var q=h-m;l=-Math.sign(q);if(Math.abs(q)<=Number.MIN_VALUE)throw Error("Invalid angles");var p=Math.abs(q/2),u=k/Math.sin(p),q=u*Math.cos((m+h)/2),t=u*Math.sin((m+h)/2),r=u*Math.cos(p),p=r*Math.cos(m),u=r*Math.sin(m),n=r*Math.cos(h),r=r*Math.sin(h);
return{aB:{eIc:a,fIc:b,Jec:l*p+d,Lec:l*u+f},arc:{left:l*q+d-k,top:l*t+f-k,um:m+Math.PI/2,WE:h-Math.PI/2},ep:{x:l*n+d,y:l*r+f}}};a.hwc=function(b,e,d,f){var h=f||a.Cxc(b,e);if(0===h.length)return[];if(1===h.length)return a.I1b(b,e,d);f=[];var l,k,m;for(m=0;m<h.length;++m)for(l=b.slice(h[m].Bc,h[m].Hg+1),k=e.slice(h[m].Bc,h[m].Hg+1),l=a.I1b(l,k,d),k=0;k<l.length;++k)f.push(l[k].Bc),f.push(l[k].Hg);f.sort(function(a,b){return a-b});b=[];for(m=0;m<f.length;m+=2)b.push({Bc:f[m],Hg:f[m+1]});return b};a.Cxc=
function(a,b){for(var d=Math.min(a.length,b.length),f=[],h,l,k,m,q=0;q<d;++q){h=a[q];l=b[q];for(var p=q+2;p<d;++p)if(k=a[p],m=b[p],h===k&&l===m){f.push({Bc:q,Hg:p});q=p;break}}0===f.length&&f.push({Bc:0,Hg:f.length-1});return f};a.I1b=function(a,b,d){var f=[],h=Math.min(a.length,b.length),l=[],k,m,q,p,u;for(k=1;k<h;++k)b[k]===b[k-1]||b[k]<d&&b[k-1]<d||b[k]>d&&b[k-1]>d||(b[k-1]>b[k]?(q=b[k],u=b[k-1],m=a[k],p=a[k-1]):(q=b[k-1],u=b[k],m=a[k-1],p=a[k]),q!==d&&(m=m===p?p:m+(d-q)*(p-m)/(u-q),l.push(m)));
if(2>l.length)return f;l.sort(function(a,b){return a-b});for(k=0;k<l.length;k+=2)f.push({Bc:l[k],Hg:l[k+1]});return f};a.b8b=function(a,b){return Math.abs(a-b)<=1E-12*Math.min(Math.abs(a),Math.abs(b))};return a}();
_geo.c.hd.Jr=function(){function b(a,b){this.doa=window.NaN;this.iT=new _geo.c.f.sa;this.Hv(a,b)}var a=new _geo.c.f.sa;_geo.c.ja(b,"geotoolkit.deviation.Line");b.prototype.Hv=function(b,e){if("number"===typeof e)this.iT.lb(b.ga(),b.ea()),this.doa=e;else if(e instanceof _geo.c.f.sa){a.lb(e.ea()-b.ea(),b.ga()-e.ga());var d=_geo.c.hd.gc.Aua(a,a),f;d>_geo.c.f.Math.Hc?(f=Math.sqrt(d),d=a.ga()/f,f=a.ea()/f):(d=1,f=0);this.iT.lb(d,f);this.doa=-_geo.c.hd.gc.Aua(this.iT,b)}else this.doa=b.doa,this.iT.lb(b.iT.ga(),
b.iT.ea())};b.prototype.l$a=function(){return this.iT};b.prototype.bPc=function(a){this.iT=a};b.prototype.IBa=function(){return this.doa};b.prototype.$Oc=function(a){this.doa=a};b.prototype.Lh=function(a){return _geo.c.hd.gc.Aua(this.iT,a)+this.doa};b.prototype.cua=function(a){var b=this.Lh(a);return new _geo.c.f.sa(a.ga()-this.iT.ga()*b,a.ea()-this.iT.ea()*b)};b.prototype.FNc=function(a){var b=2*this.Lh(a);return new _geo.c.f.sa(a.ga()-this.iT.ga()*b,a.ea()-this.iT.ea()*b)};b.Qqc=function(a,b){var d=
a.l$a(),f=b.l$a();return Math.abs(d.ga()*f.ea()-f.ga()*d.ea())<_geo.c.f.Math.Hc};b.x8b=function(a,b){var d=a.l$a(),f=b.l$a(),h=d.ga()*f.ea()-f.ga()*d.ea(),l=a.IBa(),k=b.IBa(),m=d.ea()*k-f.ea()*l,d=f.ga()*l-d.ga()*k;return new _geo.c.f.sa(m/h,d/h)};return b}();
_geo.c.hd.Tic=function(){function b(){this.Lf;this.s2a=[]}_geo.c.ja(b,"geotoolkit.deviation.MappedPixel");b.prototype.clear=function(){this.s2a=[]};b.prototype.append=function(a){this.s2a.push(a)};b.prototype.get=function(a){return this.s2a[a]};b.prototype.cc=function(){return this.s2a.length};return b}();
_geo.c.hd.HYa=function(){function b(){this.Uoa=[]}function a(a){var b=a.cc(),d=a.dg();a=a.Yg();var e=0===b||d[0]===d[b-1]&&a[0]===a[b-1];if(b<(e?4:3))return 0;for(var f=0,g=1;g<b;++g)f+=d[g-1]*a[g]-a[g-1]*d[g];e||(f+=d[b-1]*a[0]-a[b-1]*d[0]);return Math.abs(f/2)}function g(a,b,d){this.Qi=a;this.Fi=b;this.qOa=d}var e=_geo.c.hd.gc,d=8;_geo.c.ja(b,"geotoolkit.deviation.PixelMapper");b.prototype.te=_geo.c.Ua;var f=new _geo.c.f.sa,h=new _geo.c.f.sa,l=new _geo.c.f.sa,k=new _geo.c.f.sa,m=new _geo.c.f.If,
q=new _geo.c.f.If,p=new _geo.c.f.Rect;b.prototype.PHc=function(b,d,r){var n=b.ga();b=b.ea();n=[this.te(f.lb(n,b)),this.te(h.lb(n+1,b)),this.te(l.lb(n+1,b+1)),this.te(k.lb(n,b+1))];n.forEach(function(a){a.y*=r});b=0>n[0].x?1-e.dO(n[0].x):-e.dO(n[0].x);for(var v=0>n[0].y?1-e.dO(n[0].y):-e.dO(n[0].y),w=window.Infinity,x=-window.Infinity,y=window.Infinity,B=-window.Infinity,A=0;A<n.length;A++)n[A].x+=b,n[A].y+=v,w=Math.min(w,n[A].x),x=Math.max(x,n[A].x),y=Math.min(y,n[A].y),B=Math.max(B,n[A].y);b=new _geo.c.hd.Tic;
if(_geo.c.f.Rect.iz.GA(p.Tb(w,y,x,B)))n=B-y,v=x-w,B=0+n*w+-v*B,B+=-n*x,B+=v*y,b.append(new g(0,0,B));else for(v=e.dO(n[0].x),A=e.dO(n[0].y),w=Math.floor(w),x=Math.ceil(x),y=Math.floor(y),B=Math.ceil(B);w<x;++w)for(var C=y;C<B;++C){var D=new _geo.c.f.Jf;D.zi(m.hl([n[0].x,n[1].x,n[2].x,n[3].x],[n[0].y,n[1].y,n[2].y,n[3].y]),D);D=D.Nd(q.hl([w,w+1,w+1,w],[C,C,C+1,C+1]));0<D.length&&b.append(new g(w-v,C-A,a(D[0])))}this.Uoa[d]=b};b.prototype.Pwb=function(a,b){var f=this.te(a),g=f.ga()-(0>f.ga()?e.dO(f.ga())-
1:e.dO(f.ga())),h=f.ea()-(0>f.ea()?e.dO(f.ea())-1:e.dO(f.ea())),g=e.dO(g*d)+e.dO(h*d)*d;this.Uoa[g]&&0!==this.Uoa[g].cc()||this.PHc(a,g,b);this.Uoa[g].Lf=f;return this.Uoa[g]};b.prototype.Pob=function(){for(var a=0;a<this.Uoa.length;++a)this.Uoa[a].clear()};return b}();
_geo.c.hd.glc=function(){function b(){_geo.c.hd.HYa.call(this);this.iI=null;this.$c=new _geo.c.f.Fa;this.r=new _geo.c.f.Rect;this.v3a=new _geo.c.f.sa}_geo.c.na(b,_geo.c.hd.HYa);_geo.c.ja(b,"geotoolkit.deviation.TVDTrajectoryStation");b.prototype.Xl=function(){return this.r};b.prototype.pi=function(){return this.$c.hb(this.v3a.lb(this.r.ua(),this.r.ta()))};b.prototype.Xq=function(){return this.$c.hb(this.v3a.lb(this.r.ua(),this.r.xa()))};b.prototype.Zr=function(){return this.$c.hb(this.v3a.lb(this.r.ya(),
this.r.ta()))};b.prototype.Do=function(){return this.$c.hb(this.v3a.lb(this.r.ya(),this.r.xa()))};b.prototype.qJ=function(){return this.iI=this.iI||this.$c.me()};b.prototype.$a=function(){return this.$c};b.prototype.sc=function(a){this.$c=a;this.iI=null;this.Pob();return this};b.prototype.offset=function(a,b){this.$c.tC(this.$c.Ti()+a,this.$c.si()+b);this.iI=null;return this};b.prototype.jHc=function(){var a=this.r.ua(),b=this.r.ya(),e=this.r.ta(),d=this.r.xa(),f=this.$c.Vf(a,d),h=f.ga(),f=f.ea(),
l=this.$c.Vf(b,e),k=l.ga(),l=l.ea(),a=this.$c.Vf(a,e),e=a.ga(),a=a.ea(),b=this.$c.Vf(b,d),m=b.ga(),d=b.ea(),b=Math.min(Math.min(h,k),Math.min(e,m)),h=Math.max(Math.max(h,k),Math.max(e,m)),k=Math.min(Math.min(f,l),Math.min(a,d)),f=Math.max(Math.max(f,l),Math.max(a,d));return new _geo.c.f.Rect(b,k,h,f)};b.prototype.contains=function(a){a=this.qJ().hb(a);return this.r.contains(a)};b.prototype.te=function(a){return this.qJ().hb(a)};b.prototype.transform=function(a){return this.$c.hb(a)};b.prototype.$0=
function(a,b){return this.Pwb(a,b)};return b}();
_geo.c.hd.kna=function(){function b(a,b){_geo.c.hd.HYa.call(this);this.yG=a;this.Foa=new _geo.c.f.sa;this.Cpa=new _geo.c.f.sa;this.Bpa=new _geo.c.f.sa;this.Eoa=new _geo.c.f.sa;this.eN=this.dN=1;this.Olb=null;this.ePb=b}_geo.c.na(b,_geo.c.hd.HYa);_geo.c.ja(b,"geotoolkit.deviation.TrajectoryStation");b.prototype.pi=function(){return this.Foa};b.prototype.Dac=function(a){this.Foa.lb(a.ga(),a.ea())};b.prototype.Xq=function(){return this.Eoa};b.prototype.Cac=function(a){this.Eoa.lb(a.ga(),a.ea())};b.prototype.Zr=
function(){return this.Cpa};b.prototype.obc=function(a){this.Cpa.lb(a.ga(),a.ea())};b.prototype.Do=function(){return this.Bpa};b.prototype.nbc=function(a){this.Bpa.lb(a.ga(),a.ea())};b.prototype.pf=function(){return this.yG.ta()};b.prototype.Rac=function(a){a=Math.min(this.yG.xa(),a);this.yG.Tb(this.yG.ua(),a,this.yG.ya(),this.yG.xa());this.update()};b.prototype.Kf=function(){return this.yG.xa()};b.prototype.Lac=function(a){a=Math.max(this.yG.ta(),a);this.yG.Tb(this.yG.ua(),this.yG.ta(),this.yG.ya(),
a);this.update()};b.prototype.Xl=function(){return this.yG};b.prototype.BUa=function(a){this.yG=a};b.prototype.FMc=function(){return this.yG};b.prototype.aPc=function(a){this.yG=a};b.prototype.JU=function(){return this.dN};b.prototype.LFa=function(a){this.dN=a};b.prototype.KU=function(){return this.eN};b.prototype.MFa=function(a){this.eN=a};b.prototype.X1=function(){return this.ePb};b.prototype.HDc=function(a){this.Olb=a};b.prototype.offset=function(a){var b=a.ga();a=a.ea();this.Foa.lb(this.Foa.ga()+
b,this.Foa.ea()+a);this.Cpa.lb(this.Cpa.ga()+b,this.Cpa.ea()+a);this.Bpa.lb(this.Bpa.ga()+b,this.Bpa.ea()+a);this.Eoa.lb(this.Eoa.ga()+b,this.Eoa.ea()+a)};b.prototype.update=function(){this.Pob()};b.prototype.$0=function(a,b){var e=null;if(this.ePb&&null!=this.Olb)var e=this.te(a),d=this.yG.xa(),f=this.yG.ta(),e=(e.y-f)/(d-f),e=0>e?this.Olb.$0(a,b):this.Pwb(a,b);else e=this.Pwb(a,b);return e};b.prototype.FU=function(){var a=(this.Foa.x+this.Cpa.x)/2,b=(this.Foa.y+this.Cpa.y)/2,e=(this.Eoa.x+this.Bpa.x)/
2,d=(this.Eoa.y+this.Bpa.y)/2;return Math.sqrt((a-e)*(a-e)+(b-d)*(b-d))};b.prototype.contains=_geo.c.Ua;b.prototype.transform=_geo.c.Ua;b.prototype.uZ=_geo.c.Ua;b.prototype.XDb=_geo.c.Ua;b.prototype.u8=_geo.c.Ua;b.prototype.w8=_geo.c.Ua;return b}();
_geo.c.hd.ZXa=function(){function b(b,d,f){_geo.c.hd.kna.call(this,d,f);this.iI=null;this.$c=new _geo.c.f.Fa;null!=b&&this.$c.sc(b);this.Vl=new _geo.c.f.Fa;this.mT=new a;this.q0=new a;this.olb=2;this.Lga=new a}var a=_geo.c.f.sa,g=_geo.c.hd.gc;_geo.c.na(b,_geo.c.hd.kna);_geo.c.ja(b,"geotoolkit.deviation.LinearTrajectoryStation");b.prototype.JBc=function(){return this.olb};b.prototype.Q5a=function(){this.olb--};b.prototype.RMc=function(){this.olb++};b.prototype.FU=function(){return a.Jm(this.mT,this.q0)};
b.prototype.IGc=function(){return this.mT};b.prototype.ovc=function(){return this.q0};b.prototype.qJ=function(){return this.iI=this.iI||this.$c.me()};b.prototype.$a=function(){return this.$c};b.prototype.sc=function(a){this.$c.sc(a);this.iI=null;this.Pob()};b.prototype.bGc=function(a){this.Vl.sc(a)};b.prototype.offset=function(a){_geo.c.hd.kna.prototype.offset.call(this,a);var b=a.ga();a=a.ea();this.$c.tC(this.$c.Ti()+b,this.$c.si()+a);this.X1()&&this.Vl.tC(this.Vl.Ti()+b,this.Vl.si()+a);this.iI=
null;this.mT.lb(this.mT.ga()+b,this.mT.ea()+a);this.q0.lb(this.q0.ga()+b,this.q0.ea()+a)};b.prototype.contains=function(b){if(!this.X1())return b=this.qJ().hb(b),this.Xl().contains(b);if(this.pi().ea()<=this.Xq().ea()===this.Zr().ea()<=this.Do().ea())return g.Pyc(b,this.Xq(),this.Do(),this.Zr(),this.pi());var d=new a;return g.vpb(this.pi(),this.Zr(),this.Xq(),this.Do(),d)?g.w4b(b,this.pi(),this.Xq(),d)||g.w4b(b,this.Zr(),this.Do(),d):!1};b.prototype.te=function(b){if(!this.X1())return this.qJ().hb(b);
var d=new a,f=new a;if(!g.vpb(this.pi(),this.Zr(),this.Xq(),this.Do(),d)||!g.vpb(this.mT,this.q0,d,b,f))return b.clone();if(f.ea()<Math.min(this.mT.ea(),this.q0.ea()))return this.Xl().pi();if(f.ea()>Math.max(this.mT.ea(),this.q0.ea()))return this.Xl().Do();d=g.ud(this.Lga.lb(this.q0.ga()-this.mT.ga(),this.q0.ea()-this.mT.ea()));f=Math.abs(d)>_geo.c.f.Math.Hc?g.ud(this.Lga.lb(f.ga()-this.mT.ga(),f.ea()-this.mT.ea()))/d:Number.MAX_VALUE;d=f*this.$c.Rb()+(1-f)*this.Vl.Rb();b=Math.abs(d)<=_geo.c.f.Math.Hc?
Number.MAX_VALUE:(b.ga()-f*(this.$c.rj()*this.Xl().xa()+this.$c.Ti())-(1-f)*(this.Vl.rj()*this.Xl().ta()+this.Vl.Ti()))/d;f=f*this.Xl().xa()+(1-f)*this.Xl().ta();return new a(b,f)};b.prototype.transform=function(b){if(!this.X1())return this.$c.hb(b);var d=this.Xl().xa(),f=this.Xl().ta(),g=d-f;if(Math.abs(g)<_geo.c.f.Math.Hc)return b.ea()<f?this.Vl.hb(b):this.$c.hb(b);g=(b.ea()-f)/g;if(0>=g)return this.Vl.hb(b);if(1<=g)return this.$c.hb(b);var l=this.Vl.Rb()*b.ga()+this.Vl.rj()*f+this.Vl.Ti(),k=this.$c.Rb()*
b.ga()+this.$c.rj()*d+this.$c.Ti(),f=this.Vl.Tj()*b.ga()+this.Vl.hc()*f+this.Vl.si();b=this.$c.Tj()*b.ga()+this.$c.hc()*d+this.$c.si();return new a((k-l)*g+l,(b-f)*g+f)};b.prototype.update=function(){_geo.c.hd.kna.prototype.update.call(this);this.iI=null;var b=this.Xl(),d=this.X1()?this.Vl:this.$c;this.mT=d.hb(new a(b.rd(),b.ta()));this.q0=this.$c.hb(new a(b.rd(),b.xa()));this.Dac(d.hb(b.pi()));this.obc(d.hb(b.Zr()));this.nbc(this.$c.hb(b.Do()));this.Cac(this.$c.hb(b.Xq()));0===this.$c.Rb()?this.LFa(Math.abs(this.$c.Tj())):
0===this.$c.Tj()?this.LFa(Math.abs(this.$c.Rb())):this.LFa(Math.sqrt(this.$c.Rb()*this.$c.Rb()+this.$c.Tj()*this.$c.Tj()));0===this.$c.hc()?this.MFa(Math.abs(this.$c.rj())):0===this.$c.rj()?this.MFa(Math.abs(this.$c.hc())):this.MFa(Math.sqrt(this.$c.hc()*this.$c.hc()+this.$c.rj()*this.$c.rj()));this.X1()&&(0===this.Vl.Rb()?this.LFa(Math.max(this.JU(),Math.abs(this.Vl.Tj()))):0===this.Vl.Tj()?this.LFa(Math.max(this.JU(),Math.abs(this.Vl.Rb()))):this.LFa(Math.max(this.JU(),Math.sqrt(this.Vl.Rb()*this.Vl.Rb()+
this.Vl.Tj()*this.Vl.Tj()))),0===this.Vl.hc()?this.MFa(Math.max(this.KU(),Math.abs(this.Vl.rj()))):0===this.Vl.rj()?this.MFa(Math.max(this.KU(),Math.abs(this.Vl.hc()))):this.MFa(Math.max(this.KU(),Math.sqrt(this.Vl.hc()*this.Vl.hc()+this.Vl.rj()*this.Vl.rj()))))};b.prototype.u8=function(a){if(!this.X1())return 0===this.$c.Rb()?Math.abs(this.$c.Tj()):0===this.$c.Tj()?Math.abs(this.$c.Rb()):Math.sqrt(this.$c.Rb()*this.$c.Rb()+this.$c.Tj()*this.$c.Tj());a=this.FTb(a);return 0===a.Rb()?Math.abs(a.Tj()):
0===a.Tj()?Math.abs(a.Rb()):Math.sqrt(a.Rb()*a.Rb()+a.Tj()*a.Tj())};b.prototype.w8=function(a){if(!this.X1())return 0===this.$c.hc()?Math.abs(this.$c.rj()):0===this.$c.rj()?Math.abs(this.$c.hc()):Math.sqrt(this.$c.hc()*this.$c.hc()+this.$c.rj()*this.$c.rj());a=this.FTb(a);return 0===a.hc()?Math.abs(a.rj()):0===a.rj()?Math.abs(a.hc()):Math.sqrt(a.hc()*a.hc()+a.rj()*a.rj())};b.prototype.FTb=function(a){if(!this.X1())return this.$c;var b=this.Xl().xa(),f=this.Xl().ta(),g=b-f;if(Math.abs(g)<_geo.c.f.Math.Hc)return a.ea()<
f?this.Vl:this.$c;var l=(a.ea()-f)/g;if(0>=l)return this.Vl;if(1<=l)return this.$c;if(Math.abs(a.ea())<=_geo.c.f.Math.Hc){a=this.$c.rj()*b+this.$c.Ti();var k=this.$c.hc()*b+this.$c.si(),m=this.Vl.rj()*f+this.Vl.Ti(),q=this.Vl.hc()*f+this.Vl.si();return new _geo.c.f.Fa(this.$c.Rb()*l+this.Vl.Rb()*(1-l),this.$c.Tj()*l+this.Vl.Tj()*(1-l),(a-m)/g,(k-q)/g,(m*b-a*f)/g,(q*b-k*f)/g)}return new _geo.c.f.Fa(this.$c.Rb()*l+this.Vl.Rb()*(1-l),this.$c.Tj()*l+this.Vl.Tj()*(1-l),(this.$c.rj()*l*b+this.Vl.rj()*(1-
l)*f)/a.ea(),(this.$c.hc()*l*b+this.Vl.hc()*(1-l)*f)/a.ea(),this.$c.Ti()*l+this.Vl.Ti()*(1-l),this.$c.si()*l+this.Vl.si()*(1-l))};b.prototype.uZ=function(a,b,f,h,l){var k=this.Xl(),m=_geo.c.f.Math.Hc;k.ta()<=a.ea()+m&&k.xa()>=a.ea()-m&&g.Lu(h,this.transform(a),f,l);k.ta()>a.ea()-m&&k.ta()<b.ea()+m&&g.Lu(h,this.transform(g.OL(a,b,k.ta())),f,l);k.xa()>a.ea()-m&&k.xa()<b.ea()+m&&g.Lu(h,this.transform(g.OL(a,b,k.xa())),f,l);k.ta()<=b.ea()+m&&k.xa()>=b.ea()-m&&g.Lu(h,this.transform(b),f,l)};b.prototype.XDb=
function(a,b,f,h,l){var k=this.Xl();k.ta()<=a.ea()&&k.xa()>=a.ea()&&g.Lu(h,this.transform(a),f,l);k.xa()>b.ea()&&k.xa()<a.ea()&&g.Lu(h,this.transform(g.OL(a,b,k.xa())),f,l);k.ta()>b.ea()&&k.ta()<a.ea()&&g.Lu(h,this.transform(g.OL(a,b,k.ta())),f,l);k.ta()<=b.ea()&&k.xa()>=b.ea()&&g.Lu(h,this.transform(b),f,l)};return b}();_geo.c.hd.Mr=function(){function b(a,b){this.Oda=void 0!==a?a:-1;this.pV=b||new _geo.c.f.Rect;this.uva=Number.MAX_VALUE}_geo.c.ja(b,"geotoolkit.deviation.StationBounds");return b}();
_geo.c.hd.DLb=function(){function b(a,b){this.hYa=a;this.Mr=b}_geo.c.ja(b,"geotoolkit.deviation.StationPair");return b}();
_geo.c.hd.tKb=function(){function b(){this.Gk=[]}_geo.c.ja(b,"geotoolkit.deviation.RectMap");b.prototype.oca=function(){return this.Gk};b.prototype.clear=function(){this.Gk=[];return this};b.prototype.bEa=function(a){for(var b=0;b<this.Gk.length;b++){var e=this.Gk[b];if(a<=e.hYa)return b}return this.Gk.length};b.prototype.VHc=function(a){for(var b=this.Gk.length-1;0<=b;b--)if(this.Gk[b].hYa<=a)return b;return 0};b.prototype.$q=function(a){var b=a.hYa;if(0===this.Gk.length)this.Gk.push(a);else{var e;
for(e=0;e<this.Gk.length&&!(this.Gk[e].hYa>=b);e++);this.Gk.splice(e,0,a)}};return b}();
_geo.c.hd.Djc=function(){function b(a){this.ymb=a}function a(a,b,d){this.iB=a;this.gTa=b;this.rja=void 0!==d?d:-1}_geo.c.ja(b,"geotoolkit.deviation.PiecewiseApproximator");b.prototype.Wnb=function(b,e){var d=_geo.c.f.sa,f=[];f.push(new a(b,this.ymb.transform(b),1));f.push(new a(e,this.ymb.transform(e),-1));for(var h=0;-1!==f[h].rja;){var l=f[h],k=f[l.rja],m=d.Jm(l.gTa,k.gTa);if(1>m)h=l.rja;else{var q=new d((l.iB.ga()+k.iB.ga())/2,(l.iB.ea()+k.iB.ea())/2),p=this.ymb.transform(q),u=l.rja,k=new _geo.c.hd.Jr(l.gTa,
k.gTa),m=k.Lh(p);.5>Math.abs(m)?h=l.rja:(l.rja=f.length,f.push(new a(q,p,u)))}}return f};return b}();
_geo.c.hd.pgb=function(){function b(){_geo.c.hd.kna.call(this,new _geo.c.f.Rect,!0);this.Rw=this.Hna=this.nmb=this.i0a=this.Eg=this.oha=this.HAa=this.nMa=this.CMa=this.hN=this.i2a=this.w2a=null;this.gmc=new _geo.c.hd.Djc(this);this.Gj=this.f0=null;this.wk=window.NaN}var a=_geo.c.f.sa,g=_geo.c.f.Fa,e=_geo.c.hd.gc,d=_geo.c.hd.Jr;_geo.c.ja(b,"geotoolkit.deviation.PieSliceTrajectoryStation");_geo.c.na(b,_geo.c.hd.kna);b.prototype.FU=function(){return this.wk};b.htc=function(f,h){if(f.X1()||h.X1())return null;
var l=h.Xl(),k=f.Xl(),m,q,p,u,t=e.YHc(new a(h.Xq().ga()-h.pi().ga(),h.Xq().ea()-h.pi().ea()),new a(f.Xq().ga()-f.pi().ga(),f.Xq().ea()-f.pi().ea()));if(Math.abs(t)<_geo.c.f.Math.Hc)return null;(t=0>t)?(m=new d(f.pi(),f.Xq()),q=new d(h.pi(),h.Xq()),p=k.ua(),u=k.ya()-p):(m=new d(f.Zr(),f.Do()),q=new d(h.Zr(),h.Do()),p=k.ya(),u=k.ua()-p);if(d.Qqc(m,q))return null;m=d.x8b(q,m);q=f.te(m);var r=h.te(m);if(k.ta()>q.ea()||l.xa()<r.ea())return k.ta()>q.ea()?-1:1;f.Lac(q.ea());h.Rac(r.ea());var n=t?f.Do():
f.Xq(),l=new a(n.ga()-m.ga(),n.ea()-m.ea()),n=t?h.Zr():h.pi(),n=new a(n.ga()-m.ga(),n.ea()-m.ea()),v=Math.atan2(l.ea(),l.ga()),w=g.hp(-v,0,0),x=g.Mj(-m.ga(),-m.ea()),x=g.multiply(w,x),w=w.hb(n),n=new b;n.Hna=Math.atan2(w.ea(),w.ga());n.i0a=x;n.nmb=x.me();n.HAa=p;n.oha=u;n.hN=m;n.Eg=a.Jm(l,new a(0,0));n.Rw=v;n.Dac(f.Xq());n.obc(f.Do());n.Cac(h.pi());n.nbc(h.Zr());n.wk=Math.abs(n.Eg*n.Hna/2);n.BUa(new _geo.c.f.Rect(k.ua(),q.ea(),k.ya(),r.ea()));k=new d(m,t?f.Do():f.Xq());p=new d(m,t?h.Zr():h.pi());
0<k.Lh(t?h.Zr():h.pi())?(n.w2a=k,n.i2a=p,t?(t=f.Do(),k=h.Zr()):(t=f.Xq(),k=h.pi())):(n.w2a=p,n.i2a=k,t?(k=f.Do(),t=h.Zr()):(k=f.Xq(),t=h.pi()));n.CMa=new a(t.ga(),t.ea());n.nMa=new a(k.ga(),k.ea());return n};b.prototype.update=function(a,b){this.BUa(new _geo.c.f.Rect(a.Xl().ua(),a.Kf(),a.Xl().ya(),b.pf()))};b.prototype.offset=function(a){_geo.c.hd.kna.prototype.offset.call(this,a);var b=a.ga();a=a.ea();this.hN.lb(this.hN.ga()+b,this.hN.ea()+a);this.CMa.lb(this.CMa.ga()+b,this.CMa.ea()+a);this.nMa.lb(this.nMa.ga()+
b,this.nMa.ea()+a);b=g.hp(-this.Rw,0,0);a=g.Mj(-this.hN.ga(),-this.hN.ea());this.i0a=g.multiply(b,a);this.nmb=this.i0a.me();this.w2a.Hv(this.hN,this.CMa);this.i2a.Hv(this.hN,this.nMa)};b.prototype.contains=function(b){return a.Jm(this.hN,b)<=this.Eg&&0<this.w2a.Lh(b)&&0>this.i2a.Lh(b)};b.prototype.te=function(b){var d=b.ga(),e=b.ea();Math.abs(this.Eg)>_geo.c.f.Math.Hc&&(d=this.HAa+a.Jm(b,this.hN)/this.Eg*this.oha);b=this.i0a.hb(b);Math.abs(this.Hna)>_geo.c.f.Math.Hc&&(e=this.Xl().ta()+Math.atan2(b.ea(),
b.ga())/this.Hna*this.Xl().da());return new a(d,e)};b.prototype.transform=function(b){var d=Math.abs(this.oha)>_geo.c.f.Math.Hc?(b.ga()-this.HAa)/this.oha:b.ga()-this.HAa;b=this.Xl().da()>_geo.c.f.Math.Hc?(b.ea()-this.Xl().ta())/this.Xl().da():b.ea()-this.Xl().ta();b=g.hp(this.Hna*b,0,0);d=new a(this.Eg*d,0);return this.nmb.hb(b.hb(d))};b.prototype.u8=function(a){return Math.abs(this.oha)>_geo.c.f.Math.Hc?Math.abs(this.Eg/this.oha):Math.abs(this.Eg)};b.prototype.w8=function(a){a=Math.abs(this.oha)>
_geo.c.f.Math.Hc?(a.ga()-this.HAa)/this.oha:a.ga()-this.HAa;return this.Xl().da()>_geo.c.f.Math.Hc?Math.abs(this.Hna*this.Eg*a/this.Xl().da()):Math.abs(this.Hna*this.Eg*a)};b.prototype.uZ=function(a,b,d,g,m){if(_geo.c.hd.gc.b8b(a.ea(),b.ea()))this.J4b(a,b,d,g,m);else{this.f0=!0;var q=this.Xl();q.ta()<=a.ea()&&q.xa()>=a.ea()&&this.gl(g,a,d,m);q.ta()>a.ea()&&q.ta()<b.ea()&&this.gl(g,e.OL(a,b,q.ta()),d,m);q.xa()>a.ea()&&q.xa()<b.ea()&&this.gl(g,e.OL(a,b,q.xa()),d,m);q.ta()<=b.ea()&&q.xa()>=b.ea()&&this.gl(g,
b,d,m)}};b.prototype.XDb=function(a,b,d,g,m){if(_geo.c.hd.gc.b8b(a.ea(),b.ea()))this.J4b(a,b,d,g,m);else{this.f0=!0;var q=this.Xl();q.ta()<=a.ea()&&q.xa()>=a.ea()&&this.gl(g,a,d,m);q.xa()>b.ea()&&q.xa()<a.ea()&&this.gl(g,e.OL(a,b,q.xa()),d,m);q.ta()>b.ea()&&q.ta()<a.ea()&&this.gl(g,e.OL(a,b,q.ta()),d,m);q.ta()<=b.ea()&&q.xa()>=b.ea()&&this.gl(g,b,d,m)}};b.prototype.gl=function(a,b,d,g){if(this.f0)e.Lu(a,this.transform(b),d,g),this.Gj=b&&b.clone(),this.f0=!1;else{b=this.gmc.Wnb(this.Gj,b);var m=0;
do m=b[m].rja,e.Lu(a,b[m].gTa,d,g);while(-1!==b[m].rja)}};b.prototype.J4b=function(a,b,d,g,m){e.Lu(g,this.transform(a),d,m);e.Lu(g,this.transform(b),d,m)};return b}();
_geo.c.hd.kwa=function(){function b(){}_geo.c.ja(b,"geotoolkit.deviation.DeviatedTransformation");b.prototype.update=_geo.c.Ua;b.prototype.transform=_geo.c.Ua;b.prototype.te=_geo.c.Ua;b.prototype.uZ=_geo.c.Ua;b.prototype.BF=_geo.c.Ua;b.prototype.sra=_geo.c.Ua;b.prototype.contains=_geo.c.Ua;b.prototype.u8=_geo.c.Ua;b.prototype.w8=_geo.c.Ua;b.prototype.iUb=_geo.c.Ua;b.prototype.Gub=function(){return{xMin:this.nR(),yMin:this.oR(),xMean:this.d$a(),yMean:this.e$a(),xMax:this.JU(),yMax:this.KU()}};b.prototype.JU=
_geo.c.Ua;b.prototype.KU=_geo.c.Ua;b.prototype.nR=_geo.c.Ua;b.prototype.oR=_geo.c.Ua;b.prototype.d$a=function(){var a=this.nR(),b=this.JU();return Math.sqrt((a*a+b*b)/2)};b.prototype.e$a=function(){var a=this.oR(),b=this.KU();return Math.sqrt((a*a+b*b)/2)};b.prototype.$0=_geo.c.Ua;b.prototype.k7=_geo.c.Ua;return b}();_geo.c.hd.Ixa=function(){function b(){}_geo.c.ja(b,"geotoolkit.deviation.Transformer2d");b.prototype.create=_geo.c.Ua;return b}();
_geo.c.hd.SLb=function(){function b(a,b,f){_geo.c.hd.kwa.call(this);this.mf=a.transformation||f;this.Cp=a.trajectory;this.fD=a.trackWidth;this.qz=a.filter;this.wg=a.offset;b=_geo.c.Ja(b,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1});this.lmb=b.scaleWidth;this.hlb=b.minWidth;this.zga=b.maxWidth;this.g4a=b.widthScaleX;this.Qe=[];this.dD=new _geo.c.hd.tKb;this.s5=this.r5=this.eN=this.dN=1;this.iSb=new _geo.c.f.Fa;this.jSb=new _geo.c.f.Fa;this.lka()}var a=_geo.c.f.sa,
g=_geo.c.hd.gc;_geo.c.na(b,_geo.c.hd.kwa);_geo.c.ja(b,"geotoolkit.deviation.TVDTransformation");b.prototype.k7=function(a){var b=this.Qe.length,f=_geo.c.f.Math.findIndex(null,this.Qe,0,b,function(b){b=b.r.xa()-a;return Math.abs(b)>_geo.c.f.Math.Hc?b:0});0>f?f=~f:++f;f>=b&&(f=b-1);return f};b.prototype.update=function(a){if(Math.abs(a.Rb()-this.mf.Rb())>_geo.c.f.Math.Hc||Math.abs(a.hc()-this.mf.hc())>_geo.c.f.Math.Hc)this.mf=a,this.lka();else{var b=a.Ti()-this.mf.Ti(),f=a.si()-this.mf.si();if(Math.abs(b)>
_geo.c.f.Math.Hc||Math.abs(f)>_geo.c.f.Math.Hc){for(var g=0;g<this.Qe.length;++g)this.Qe[g].offset(b,f);this.iSb.sc(1,0,0,1,b,f);b=this.dD.oca();for(f=0;f<b.length;++f)g=b[f],this.iSb.yb(g.Mr.pV,g.Mr.pV)}this.mf=a}return!0};b.prototype.transform=function(a){var b=this.k7(a.ea());for(0>b&&(b=0);b<this.Qe.length;++b){if(a.ea()<=this.Qe[b].r.xa()&&a.ea()>=this.Qe[b].r.ta())return this.Qe[b].transform(a);if(this.Qe[b].r.xa()>a.ea())break}return new _geo.c.f.sa};b.prototype.te=function(a){for(var b=this.dD.oca(),
f=this.dD.bEa(a.ea()-this.mf.si());f<b.length;++f){var g=b[f];if(this.Qe[g.Mr.Oda].contains(a))return this.Qe[g.Mr.Oda].te(a);if(a.ea()<g.Mr.pV.xa())break}return new _geo.c.f.sa};b.prototype.uZ=function(b,d,f){if(0!==this.Qe.length){var h=new a,l=this.k7(b.ea()),k;if(b.ea()<=d.ea())for(;l<this.Qe.length&&!(k=this.Qe[l],k.r.ta()<=b.ea()&&k.r.xa()>=b.ea()&&g.Lu(f,k.transform(b),h,this.qz),k.r.ta()>=b.ea()&&k.r.ta()<=d.ea()&&g.Lu(f,k.transform(g.OL(b,d,k.r.ta())),h,this.qz),l===this.Qe.length-1&&k.r.xa()>=
b.ea()&&k.r.xa()<=d.ea()&&g.Lu(f,k.transform(g.OL(b,d,k.r.xa())),h,this.qz),k.r.ta()<=d.ea()&&k.r.xa()>=d.ea()&&g.Lu(f,k.transform(d),h,this.qz),k.r.xa()>=d.ea());++l);else for(l>=this.Qe.length&&(l=this.Qe.length-1);0<=l&&!(k=this.Qe[l],k.r.ta()<=b.ea()&&k.r.xa()>=b.ea()&&g.Lu(f,k.transform(b),h,this.qz),k.r.xa()>=d.ea()&&k.r.xa()<=b.ea()&&g.Lu(f,k.transform(g.OL(b,d,k.r.xa())),h,this.qz),0===l&&k.r.ta()>=d.ea()&&k.r.ta()<=b.ea()&&g.Lu(f,k.transform(g.OL(b,d,k.r.ta())),h,this.qz),k.r.ta()<=d.ea()&&
k.r.xa()>=d.ea()&&g.Lu(f,k.transform(d),h,this.qz),k.r.ta()<=d.ea());--l);}};b.prototype.BF=function(b,d,f,h){var l=b.length;if(1<l&&0<this.Qe.length){(h=h&&!g.K7b(b,l))&&++l;var k,m,q;f?(k=f.Rb(),m=f.hc(),q=f.Ti(),f=f.si()):(m=k=1,f=q=0);for(var p=new a,u=new a(b[0].ga()*k+q,b[0].ea()*m+f),t=new a,r=0,n=0,v,w=0;w<l-1;++w){v=h&&w===l-2?0:w+1;t.lb(b[v].ga()*k+q,b[v].ea()*m+f);if(0>r||r>=this.Qe.length||!(this.Qe[r].r.ta()<=u.ea()&&this.Qe[r].r.xa()>=u.ea()))r=this.k7(u.ea());if(u.ea()<=t.ea())for(;r<
this.Qe.length&&!(v=this.Qe[r],0===w&&v.r.ta()<=u.ea()&&v.r.xa()>=u.ea()&&g.Lu(d,v.transform(u),p,this.qz),v.r.ta()>u.ea()&&v.r.ta()<t.ea()&&g.Lu(d,v.transform(g.OL(u,t,v.r.ta())),p,this.qz),r===this.Qe.length-1&&v.r.xa()>u.ea()&&v.r.xa()<t.ea()&&g.Lu(d,v.transform(g.OL(u,t,v.r.xa())),p,this.qz),v.r.ta()<=t.ea()&&v.r.xa()>=t.ea()&&(g.Lu(d,v.transform(t),p,this.qz),n=r),v.r.xa()>=t.ea());++r);else for(r>=this.Qe.length&&(r=this.Qe.length-1);0<=r&&!(v=this.Qe[r],0===w&&v.r.ta()<=u.ea()&&v.r.xa()>=u.ea()&&
g.Lu(d,v.transform(u),p,this.qz),v.r.xa()>t.ea()&&v.r.xa()<u.ea()&&g.Lu(d,v.transform(g.OL(u,t,v.r.xa())),p,this.qz),0===r&&v.r.ta()>t.ea()&&v.r.ta()<u.ea()&&g.Lu(d,v.transform(g.OL(u,t,v.r.ta())),p,this.qz),v.r.ta()<=t.ea()&&v.r.xa()>=t.ea()&&(g.Lu(d,v.transform(t),p,this.qz),n=r),v.r.ta()<=t.ea());--r);r=n;u.lb(t.ga(),t.ea())}}};b.prototype.sra=function(a){return 1>this.Qe.length?new _geo.c.f.Rect:new _geo.c.f.Rect(0,a.ta(),this.fD,a.xa())};b.prototype.contains=function(a){for(var b=this.dD.oca(),
f=this.dD.bEa(a.ea()-this.mf.si());f<b.length;++f){var g=b[f];if(g.Mr.pV.contains(a)&&this.Qe[g.Mr.Oda].contains(a))return!0;if(a.ea()<g.Mr.pV.xa())break}return!1};b.prototype.u8=function(a){return this.dN};b.prototype.w8=function(a){return this.eN};b.prototype.JU=function(){return this.dN};b.prototype.KU=function(){return this.eN};b.prototype.nR=function(){return this.r5};b.prototype.oR=function(){return this.s5};b.prototype.$0=function(a,b){var f=this.k7(a.ea());for(0>f&&(f=0);f<this.Qe.length;++f){if(a.ea()<=
this.Qe[f].r.xa()&&a.ea()>=this.Qe[f].r.ta())return this.Qe[f].$0(a,b);if(this.Qe[f].r.xa()>a.ea())break}return null};b.prototype.Dzb=function(a){return this.lmb};b.prototype.lka=function(){this.Qe=[];this.dD.clear();for(var b=0,d=this.Dzb(Math.abs(this.mf.Rb())),f=1;f<this.Cp.count();++f)if(!(this.Cp.ea(b)>=this.Cp.ea(f))){var h=this.Cp.ga(b),l=this.Cp.ea(b),k=this.Cp.ga(f),m=this.Cp.ea(f);if(1<f&&f<this.Cp.count()-1){var q=new a(h,l),p=new a(k,m),u=this.mf.hb(q),t=this.mf.hb(p);if(.5>Math.abs(u.ga()-
t.ga())&&.5>Math.abs(u.ea()-t.ea()))continue;if(1<b&&(u=new a(this.Cp.ga(b-1),this.Cp.ea(b-1)),g.v4b(u,p,q)))continue}k=(k-h)/(m-l);h-=k*l;l=new _geo.c.hd.glc;this.jSb.sc(d,0,k,1,h,0);l.sc(_geo.c.f.Fa.multiply(this.mf,this.jSb));l.r=new _geo.c.f.Rect(0,this.Cp.ea(b),this.fD,this.Cp.ea(f));this.z4a(l);b=f}this.dN=Math.abs(d*this.mf.Rb());this.eN=Math.abs(this.mf.hc());this.r5=Math.abs(d*this.mf.Rb());this.s5=Math.abs(this.mf.hc())};b.prototype.z4a=function(a){var b=a.jHc(),f=new _geo.c.hd.Mr(this.Qe.length,
b),b=b.xa()-this.mf.si();this.dD.$q(new _geo.c.hd.DLb(b,f));this.Qe.push(a)};b.prototype.zrb=function(){return this.mf};return b}();
_geo.c.hd.TLb=function(){function b(a){_geo.c.hd.Ixa.call(this);this.pa=_geo.c.Ja(a,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1})}_geo.c.na(b,_geo.c.hd.Ixa);_geo.c.ja(b,"geotoolkit.deviation.TVDTransformer");b.prototype.xb=function(){return _geo.c.Ja(this.pa,{})};b.prototype.bb=function(a){_geo.c.Ja(a,this.pa)};b.prototype.create=function(a,b){return new _geo.c.hd.SLb(a,this.pa,b)};return b}();
_geo.c.hd.LJb=function(){function b(a,b,e,d){this.$F=a?a:0;this.FP=b?b:0;this.ojb=e?e:0;this.Wx=d?d:null}_geo.c.ja(b,"geotoolkit.deviation.PiecewiseLinearApproximation");b.prototype.aB=function(){return this.Wx};b.prototype.error=function(){return this.ojb};b.prototype.Yqc=function(){return this.$F};b.prototype.Jqb=function(){return this.FP};b.prototype.count=function(){return this.FP-this.$F+1};b.prototype.fba=function(a){this.$F=a.$F;this.FP=a.FP;this.ojb=a.ojb;this.Wx=a.Wx;return this};return b}();
_geo.c.hd.Ejc=function(){function b(a,b,d){this.Cp=a;this.Ppc=b;this.C0a=d;this.Hfa=0;this.Iaa=null==a?0:a.count();this.hN=new _geo.c.hd.LJb;this.bOb=[];for(a=0;a<this.Iaa;++a)this.bOb[a]=this.Ppc.hb(this.uBc(a));this.next()}function a(){this.Znc=new _geo.c.f.sa;this.cN=new _geo.c.f.sa;this.KPb=this.flb=0;this.D2a=new _geo.c.f.sa}_geo.c.ja(b,"geotoolkit.deviation.PiecewiseLinearIteratorImpl");b.prototype.Qha=function(a){return 0<=a&&a<this.Iaa?this.bOb[a]:new _geo.c.f.sa};b.prototype.uBc=function(a){return 0<=
a&&a<this.Iaa?new _geo.c.f.sa(this.Cp.ga(a),this.Cp.ea(a)):new _geo.c.f.sa};b.prototype.depth=function(a){return 0<=a&&a<this.Iaa?this.Cp.Lc(a):0};b.prototype.object=function(){return this.hN};b.prototype.end=function(){return 0===this.Iaa||this.Hfa===this.Iaa-1};b.prototype.next=function(){this.hN.Jqb()&&(this.Hfa=this.hN.Jqb());this.end()||(this.hN=this.Wnb())};b.prototype.Cc=function(a,b){for(var d=0,f=0,h=b-a+1,l=a;l<=b;++l)var k=this.Qha(l),d=d+k.ga(),f=f+k.ea();return new _geo.c.f.sa(d/h,f/
h)};b.prototype.q6b=function(a,b,d){for(var f=this.Cc(a,b),h=0,l=0,k=0;a<=b;++a)var m=this.Qha(a),q=m.ga()-f.ga(),m=m.ea()-f.ea(),h=h+m*m,l=l-q*m,k=k+q*q;d.D2a=f;b=h+k;h=.5*(h-k);k=Math.sqrt(l*l+h*h);d.KPb=.5*b+k;d.cN.lb(-l,h-k);l=_geo.c.hd.gc.Aua(d.cN,d.cN);0===l?d.cN.lb(1,0):(l=Math.sqrt(l),d.cN.lb(d.cN.ga()/l,d.cN.ea()/l));d.flb=b-d.KPb;d.Znc=new _geo.c.f.sa(-d.cN.ea(),d.cN.ga())};b.prototype.cqb=function(a,b,d,f,h){a=b*(this.depth(d)-a);f=_geo.c.f.sa.Jm(h,f);return Math.abs(a-f)};b.prototype.zNc=
function(a,b,d){if(2>b-a)return 0;d=new _geo.c.hd.Jr(d.cN,-_geo.c.hd.gc.Aua(d.cN,d.D2a));for(var f=0;a<=b;++a){var h=Math.abs(d.Lh(this.Qha(a)));f<h&&(f=h)}return f};b.prototype.asc=function(a,b,d){if(2>b-a)return!0;d=new _geo.c.hd.Jr(d.cN,-_geo.c.hd.gc.Aua(d.cN,d.D2a));var f=d.cua(this.Qha(a)),h=d.cua(this.Qha(b)),l=this.depth(a),k=this.depth(b);if(Math.abs(k-l)<_geo.c.f.Math.Hc)return!1;for(var h=_geo.c.f.sa.Jm(f,h)/(k-l),m,q=a+1;q<=b&&(m=d.cua(this.Qha(q)))===f;){if(this.cqb(l,h,q,f,m)>this.C0a.ga())return!1;
++q}if(q>b)return!0;m=d.cua(this.Qha(q));if(this.cqb(l,h,q,f,m)>this.C0a.ga())return!1;a=_geo.c.f.Math.sign(m.ga()-f.ga());k=_geo.c.f.Math.sign(m.ea()-f.ea());for(q+=1;q<=b;++q){var p=d.cua(this.Qha(q));if(this.cqb(l,h,q,f,p)>this.C0a.ga())return!1;if(p!==m){if(_geo.c.f.Math.sign(p.ga()-m.ga())!==a||_geo.c.f.Math.sign(p.ea()-m.ea())!==k)return!1;m=p}}return!0};b.prototype.Wnb=function(){var b=this.Iaa-this.Hfa-1,e,d,f=this.Hfa+1,h=new a,l=new a,k,m;if(1<b)for(;0<b;)e=Math.floor(b/2),d=f+e,this.q6b(this.Hfa,
d,l),m=Math.abs(l.flb)>_geo.c.f.Math.Hc?Math.sqrt(Math.abs(l.flb)):0,m<=this.C0a.ea()&&this.asc(this.Hfa,d,l)?(h=l,k=m,f=d,b-=e+1):b=e;else this.q6b(this.Hfa,this.Iaa-1,h),k=0,f=this.Iaa-1;return new _geo.c.hd.LJb(this.Hfa,f,k,new _geo.c.hd.Jr(h.cN,-_geo.c.hd.gc.Aua(h.cN,h.D2a)))};return b}();
_geo.c.hd.Fjc=function(){function b(b,d,e){_geo.c.hd.kwa.call(this);b=_geo.c.Ja(b,{filter:!0,trackWidth:0,offset:0});this.Cp=b.trajectory;this.qz=b.filter;this.fD=b.trackWidth;this.wg=b.offset;e&&(e=e.clone());this.wa=new a(e);this.mf=e;this.fPb=d.joinSegments;this.nNb=d.approxThreshold;this.fmc=void 0!==d.approxThresholdMd?d.approxThresholdMd:this.nNb;this.lmb=d.scaleWidth;this.hlb=d.minWidth;this.zga=d.maxWidth;this.g4a=d.widthScaleX;this.tnb=d.widthScaleY;this.lI=-1;this.Wxa=1;this.Yna=[];this.BG=
new m;this.uKc=new m;this.Yw=new l;this.Wyc();this.lka();this.u9b()}function a(a){this.mf=a;this.Qe=[];this.dD=new _geo.c.hd.tKb;this.$P=this.zNb=this.Bza=this.Aza=this.s5=this.r5=this.eN=this.dN=1}function g(a,b){return b/(0===a.Tj()?Math.abs(a.hc()):Math.sqrt(a.hc()*a.hc()+a.rj()*a.rj()))}function e(a,b){return Math.abs(b)>Math.abs(a)?0>b?-Math.atan(a/b):Math.PI-Math.atan(a/b):0>a?-Math.PI/2+Math.atan(b/a):Math.PI/2+Math.atan(b/a)}function d(a,b){return a.xx===b.xx&&a.yy===b.yy}function f(a){var b=
_geo.c.f.Math.rzb(a.Rb(),5);a=_geo.c.f.Math.rzb(a.hc(),5);return{xx:b,yy:a}}var h=16,l=_geo.c.f.sa,k=_geo.c.f.Rect,m=_geo.c.f.Fa;_geo.c.na(b,_geo.c.hd.kwa);_geo.c.ja(b,"geotoolkit.deviation.PiecewiseTransformation");b.prototype.wHc=function(){this.wa.zNb=1;var a=this.wa.Qe.length;if(a){var b=this.wa.Qe[0],a=this.wa.Qe[a-1],b=b.pf(),a=a.Kf(),d=[new l(0,b),new l(0,a)],e=[];this.BF(d,e,this.mf);for(var f=d=0;f<e.length-1;++f)d+=l.Jm(e[f],e[f+1]);d&&(this.wa.zNb=Math.max(1,2*_geo.c.hd.gc.dO(.5+d/Math.abs(a-
b))))}};b.prototype.k7=function(a){var b=this.wa.Qe.length,d=_geo.c.f.Math.findIndex(null,this.wa.Qe,null,null,function(b){b=b.Xl().xa()-a;return Math.abs(b)>_geo.c.f.Math.Hc?b:0});0>d?d=~d:++d;d>=b&&(d=b-1);return d};b.prototype.transform=function(a,b){a=b.hb(a);var d=this.k7(a.ea());for(0>d&&(d=0);d<this.wa.Qe.length;++d){var e=this.wa.Qe[d].Xl();if(a.ea()<=e.xa()&&a.ea()>=e.ta()||e.xa()>a.ea())return this.wa.Qe[d].transform(a)}return 0<this.wa.Qe.length?this.wa.Qe[this.wa.Qe.length-1].transform(a):
new l};b.prototype.te=function(a){if(0<=this.lI&&this.lI<this.wa.Qe.length){if(this.wa.Qe[this.lI].contains(a))return this.wa.Qe[this.lI].te(a);if(this.lI<this.wa.Qe.length-1&&this.wa.Qe[this.lI+1].contains(a))return this.wa.Qe[++this.lI].te(a);if(0<this.lI&&this.wa.Qe[this.lI-1].contains(a))return this.wa.Qe[--this.lI].te(a)}for(var b=this.wa.dD.oca(),d=this.wa.dD.bEa(a.ea()-this.mf.si());d<b.length;++d){var e=b[d];if(this.wa.Qe[e.Mr.Oda].contains(a))return this.lI=e.Mr.Oda,this.wa.Qe[this.lI].te(a);
if(a.ea()<e.Mr.uva)break}return new l(Number.NaN,Number.NaN)};b.prototype.uZ=function(a,b,d,e){0!==this.wa.Qe.length&&this.BF([a,b],d,e)};b.prototype.BF=function(a,b,d,e){var f=a.length;if(1<f&&0<this.wa.Qe.length){(e=e&&!_geo.c.hd.gc.K7b(a,f))&&++f;var g,h,k;d?(g=d.Rb(),h=d.hc(),k=d.Ti(),d=d.si()):(h=g=1,d=k=0);for(var m=new l(Number.MAX_VALUE,Number.MAX_VALUE),y=new l(a[0].ga()*g+k,a[0].ea()*h+d),B=new l,A=0,C=1,D=0;D<f-1;++D,++C){e&&D===f-2&&(C=0);B.lb(a[C].ga()*g+k,a[C].ea()*h+d);if(0>A||A>=this.wa.Qe.length||
!(this.wa.Qe[A].Xl().ta()<=y.ea()&&this.wa.Qe[A].Xl().xa()>=y.ea()))A=this.k7(y.ea());var E,F,J;if(y.ea()<=B.ea())for(J=A;J<this.wa.Qe.length;++J){if(E=this.wa.Qe[J],F=E.Xl(),E.uZ(y,B,m,b,this.qz),F.xa()>=B.ea()){A=J;break}}else for(A>=this.wa.Qe.length&&(A=this.wa.Qe.length-1),J=A;0<=J;--J)if(E=this.wa.Qe[J],F=E.Xl(),E.XDb(y,B,m,b,!1),F.ta()<=B.ea()){A=J;break}y.lb(B.ga(),B.ea())}}};b.prototype.contains=function(a){for(var b=this.wa.dD.oca(),d=this.wa.dD.bEa(a.ea()-this.mf.si());d<b.length;++d){var e=
b[d];if(e.Mr.pV.contains(a)&&this.wa.Qe[e.Mr.Oda].contains(a))return!0;if(a.ea()<e.Mr.uva)break}return!1};b.prototype.sra=function(a){if(1>this.wa.Qe.length)return k.ag;a=this.mf.yb(a);var b=window.Infinity,d=-window.Infinity,e=this.wa.dD.oca(),f,g,h,l;f=this.wa.dD.VHc(a.xa()-this.mf.si());0<f&&f--;f!==e.length-1&&a.Wd(e[f].Mr.pV)&&(h=this.wa.Qe[e[f].Mr.Oda],l=h.Xl(),0<=a.C6(h.pi(),h.Zr(),this.Yw,this.Yw)&&(b=l.ta()),0<=a.C6(h.Xq(),h.Do(),this.Yw,this.Yw)&&(d=l.xa()));for(f=this.wa.dD.bEa(a.ta()-
this.mf.si());f<e.length;++f){g=e[f];h=this.wa.Qe[g.Mr.Oda];l=h.Xl();if(b>l.ta()||d<l.xa()){if(!a.Wd(g.Mr.pV))continue;if(0<=a.C6(h.pi(),h.Zr(),this.Yw,this.Yw)&&0<=a.C6(h.Xq(),h.Do(),this.Yw,this.Yw))b>l.ta()&&(b=l.ta()),d<l.xa()&&(d=l.xa());else{var m=new k(a);m.Nd(g.Mr.pV);this.Yw.lb(m.ua(),m.xa());var y=h.te(this.Yw);this.Yw.lb(m.ya(),m.xa());var B=h.te(this.Yw);this.Yw.lb(m.ya(),m.ta());var A=h.te(this.Yw);this.Yw.lb(m.ua(),m.ta());var C=h.te(this.Yw);h=Math.min(y.ga(),B.ga(),A.ga(),C.ga());
var D=Math.min(y.ea(),B.ea(),A.ea(),C.ea()),E=Math.max(y.ga(),B.ga(),A.ga(),C.ga()),y=Math.max(y.ea(),B.ea(),A.ea(),C.ea());m.Tb(h,D,E,y);m.Nd(l);m.Jd()||(b>m.ta()&&(b=m.ta()),d<m.xa()&&(d=m.xa()))}}if(g.Mr.uva>a.xa())break}return b>d?k.ag:new k(0,b,this.fD,d)};b.prototype.update=function(b){var e=f(b),g=f(this.mf);if(d(e,g))return this.shift(b),!0;var h=null;this.Yna.some(function(a){return d(a.key,e)?(h=a.value,!0):!1});h?(this.wa=h,this.mf=this.wa.mf,this.wa.$P<Number.MAX_VALUE-1&&this.wa.$P++,
this.shift(b)):(this.wa=new a(b),this.mf=b,this.u9b(),this.lka());return!0};b.prototype.u8=function(a){var b=this.k7(a.ea());for(0>b&&(b=0);b<this.wa.Qe.length;++b){var d=this.wa.Qe[b].Xl();if(a.ea()<=d.xa()&&a.ea()>=d.ta())return this.wa.Qe[b].u8(a);if(d.xa()>a.ea())break}return this.wa.dN};b.prototype.w8=function(a){var b=this.k7(a.ea());for(0>b&&(b=0);b<this.wa.Qe.length;++b){var d=this.wa.Qe[b].Xl();if(a.ea()<=d.xa()&&a.ea()>=d.ta())return this.wa.Qe[b].w8(a);if(d.xa()>a.ea())break}return this.wa.eN};
b.prototype.JU=function(){return this.wa.dN};b.prototype.KU=function(){return this.wa.eN};b.prototype.nR=function(){return this.wa.r5};b.prototype.oR=function(){return this.wa.s5};b.prototype.d$a=function(){return this.wa.Aza};b.prototype.e$a=function(){return this.wa.Bza};b.prototype.$0=function(a,b){if(this.wa.Qe[this.lI]&&this.wa.Qe[this.lI].contains(a))return this.wa.Qe[this.lI].$0(a,b);for(var d=this.wa.dD.oca(),e=this.wa.dD.bEa(a.ea()-this.mf.si());e<d.length;++e){var f=d[e];if(f.Mr.pV.contains(a))return this.lI=
f.Mr.Oda,this.wa.Qe[this.lI].$0(a,b);if(a.ea()<f.Mr.uva)break}return null};b.prototype.Dzb=function(a){if(!this.lmb)return 1;a=Math.sqrt(this.Wxa*(a.Rb()/this.g4a)*(a.Rb()/this.g4a)+(1-this.Wxa)*(a.hc()/this.tnb)*(a.hc()/this.tnb));this.fD*a<this.hlb&&(a=this.hlb/this.fD);this.fD*a>this.zga&&(a=this.zga/this.fD);return a};b.prototype.dLc=function(){this.Yna.forEach(function(a){delete a.value})};b.prototype.lka=function(){var a=!1;this.wa.dN=0;this.wa.eN=0;this.wa.r5=0;this.wa.s5=0;this.wa.Aza=1;this.wa.Bza=
1;for(var b=[],d=[],f=[],h=this.Dzb(this.mf),n=this.Cp.ixc(this.mf,this.nNb,this.fmc),v=this.mf.me(),w,x,y,B,A,C=[],D,E,F=new m,J;!n.end();)if(null==w&&(A=n.object(),w=0===b.length?A.Yqc():x,y=0===b.length?A.aB().cua(this.mf.Vf(this.Cp.ga(w),this.Cp.ea(w))):B,x=A.Jqb(),B=A.aB().cua(this.mf.Vf(this.Cp.ga(x),this.Cp.ea(x))),A=v.hb(y),E=y.ea()-B.ea(),D=y.ga()-B.ga(),D=e(D,E),m.Mj(A.ga(),A.ea(),this.BG),m.multiply(this.mf,this.BG,F),this.mf.hb(A,this.Yw),m.hp(D,this.Yw.ga(),this.Yw.ea(),this.BG),m.multiply(this.BG,
F,F),D=0===F.rj()?Math.abs(F.Rb()):Math.sqrt(F.Rb()*F.Rb()+F.Tj()*F.Tj()),E=0===F.Tj()?Math.abs(F.hc()):Math.sqrt(F.hc()*F.hc()+F.rj()*F.rj()),0>this.mf.hc()&&(E=-E),0>this.mf.Rb()&&(D=-D),y=l.Jm(y,B),A=this.Cp.Lc(x)-this.Cp.Lc(w),E=Math.abs(A)>_geo.c.f.Math.Hc?1/E*(y/A):1,this.BG.sc(h/D,0,0,E,0,0),m.multiply(F,this.BG,F),this.BG.sc(1,0,0,1,-this.fD/2+this.wg,-this.Cp.Lc(w)),m.multiply(F,this.BG,F),J=new k(0,this.Cp.Lc(w),this.fD,this.Cp.Lc(x)),w=new _geo.c.hd.ZXa(F,J,!1),w.update()),this.fPb){var H=
0;0===b.length&&(b.push(y),d.push(this.Cp.Lc(0)+A));if(0<C.length){var G=C[C.length-1];f[f.length-1]-=G.FU();var K=_geo.c.hd.pgb.htc(G,w);"number"===typeof K&&(H=K,K=null);f[f.length-1]+=G.FU();0===H&&(b.push(b[b.length-1]+y),d.push(d[d.length-1]+A));if(K)C.push(K),f.push(K.FU()+f[f.length-1]);else if(-1===H)1<b.length?(b[b.length-2]=b[b.length-1],d[d.length-2]=d[d.length-1],b.pop(),d.pop(),f.pop(),C.pop(),C[C.length-1]instanceof _geo.c.hd.pgb&&(f.pop(),C.pop())):(b[b.length-1]+=y,d[d.length-1]+=
A,f[f.length-1]-=G.FU(),H=G.Xl().clone().zi(w.Xl()),w.BUa(H),w.update(),f[f.length-1]+=w.FU(),C.pop(),C.push(w),w=null,H=0);else if(1===H)b[b.length-1]+=y,d[d.length-1]+=A,f[f.length-1]+=w.FU(),w=null;else if(0===H){var M=0;D=0;K=G.Xl();D=G.transform(K.Do());E=G.transform(this.Yw.lb(K.rd(),K.xa()));var O=w.transform(J.Zr()),M=2*l.Jm(D,E);D=_geo.c.hd.gc.Mrc(D,E,O);D=Math.abs(M/2*Math.sin(D));D>_geo.c.f.Math.Hc?(M=g(w.$a(),D),D=g(G.$a(),D),f[f.length-1]-=G.FU(),G.Lac(K.xa()-D),w.Rac(J.ta()+M),f[f.length-
1]+=G.FU(),K=G.Xl(),J=w.Xl(),K=new _geo.c.hd.ZXa(w.$a(),new k(0,K.xa(),this.fD,J.ta()),!0),K.bGc(G.$a()),K.update(),C.push(K),f.push(K.FU()+f[f.length-1])):(G.Q5a(),w.Q5a())}}else w.Q5a();w&&0===H&&(C.push(w),f.push(0<f.length?w.FU()+f[f.length-1]:w.FU()),w=null);-1!==H&&n.next()}else a=this.wTb(w,a),n.next();if(this.fPb&&0<C.length)for(C[C.length-1]instanceof _geo.c.hd.ZXa&&C[C.length-1].Q5a(),n=b[b.length-1]/f[f.length-1]||1,x=0,J=w=null,H=0;H<C.length;++H)if(G=C[H],G instanceof _geo.c.hd.ZXa){if(0<
G.JBc()){for(y=0===H?0:f[H-1]*n;b[x]<y&&x<b.length-1;)x++;B=0===x?0:b[x-1];B=(y-B)/(b[x]-B);y=0===x?this.Cp.Lc(0):d[x-1];K=y*(1-B)+d[x]*B;for(y=f[H]*n;b[x]<y&&x<b.length-1;)x++;B=0===x?0:b[x-1];B=(y-B)/(b[x]-B);y=0===x?this.Cp.Lc(0):d[x-1];M=y*(1-B)+d[x]*B;y=G.IGc();B=G.ovc();A=v.hb(y);D=y.ga()-B.ga();E=y.ea()-B.ea();D=e(D,E);m.Mj(A.ga(),A.ea(),this.BG);m.multiply(this.mf,this.BG,F);this.mf.hb(A,this.Yw);m.hp(D,this.Yw.ga(),this.Yw.ea(),this.BG);m.multiply(this.BG,F,F);D=0===F.Ag?Math.abs(F.xf):Math.sqrt(F.xf*
F.xf+F.qg*F.qg);E=0===F.qg?Math.abs(F.Wf):Math.sqrt(F.Wf*F.Wf+F.Ag*F.Ag);0>this.mf.Wf&&(E=-E);0>this.mf.xf&&(D=-D);y=l.Jm(y,B);A=M-K;E=Math.abs(A)>_geo.c.f.Math.Hc?1/E*(y/A):1;m.Lm(h/D,E,this.BG);m.multiply(F,this.BG,F);m.Mj(-this.fD/2,-K,this.BG);m.multiply(F,this.BG,F);G.sc(F);G.BUa(new k(0,K,this.fD,M));G.update();w&&J&&(w.BUa(new k(J.Xl().ua(),J.Kf(),J.Xl().ya(),G.pf())),this.z4a(w),w=null);J=G}a=this.wTb(G,a)}else w=G instanceof _geo.c.hd.pgb?G:null;1<this.wa.Qe.length&&(this.wa.Aza=Math.pow(this.wa.Aza,
1/this.wa.Qe.length),this.wa.Bza=Math.pow(this.wa.Bza,1/this.wa.Qe.length));0===this.wa.dN&&(this.wa.dN=1);0===this.wa.eN&&(this.wa.eN=1);0===this.wa.r5&&(this.wa.r5=1);0===this.wa.s5&&(this.wa.s5=1);a=window.Infinity;b=this.wa.dD.oca();for(d=b.length-1;0<=d;--d)f=b[d],f.Mr.uva=a,a=Math.min(a,f.Mr.pV.ta());this.wHc()};b.prototype.wTb=function(a,b){this.z4a(a);var d=a.JU(),e=a.KU();this.wa.Aza*=d;this.wa.Bza*=e;b?(this.wa.dN=Math.max(d,this.wa.dN),this.wa.eN=Math.max(e,this.wa.eN),this.wa.r5=Math.min(d,
this.wa.r5),this.wa.s5=Math.min(e,this.wa.s5)):(this.wa.dN=d,this.wa.eN=e,this.wa.r5=d,this.wa.s5=e,b=!0);return b};b.prototype.z4a=function(a){var b=a.pi().ga(),d=a.pi().ea(),e=a.Xq().ga(),f=a.Xq().ea(),g=a.Zr().ga(),h=a.Zr().ea(),l=a.Do().ga(),m=a.Do().ea(),y=Math.min(b,e,g,l),B=Math.min(d,f,h,m),b=Math.max(b,e,g,l),d=Math.max(d,f,h,m),B=new k(y,B,b,d),y=new _geo.c.hd.Mr(this.wa.Qe.length,B),B=B.xa()-this.mf.si();this.wa.dD.$q(new _geo.c.hd.DLb(B,y));this.wa.Qe.push(a)};b.prototype.Wyc=function(){for(var a=
0,b=0,d=0,f,g,h=1;h<this.Cp.count();++h)f=this.g4a*(this.Cp.ga(d)-this.Cp.ga(h)),g=this.tnb*(this.Cp.ea(d)-this.Cp.ea(h)),1<h&&h<this.Cp.count()-1&&.5>Math.abs(f)&&.5>Math.abs(g)?h++:(b+=Math.abs(e(f,g)),a++,d=h);0<a&&(b/=a);this.Wxa=Math.sin(b);this.Wxa*=this.Wxa};b.prototype.u9b=function(){if(this.Yna.length>=h){for(var a=window.Infinity,b=0,d=0;d<this.Yna.length;++d){var e=this.Yna[d];if(a>e.value.$P&&(b=d,a=e.value.$P,1===a))break}this.Yna.splice(b,1)}this.Yna.push({key:f(this.mf),value:this.wa})};
b.prototype.shift=function(a){var b=a.Ti()-this.mf.Ti(),d=a.si()-this.mf.si();if(Math.abs(b)>_geo.c.f.Math.Hc||Math.abs(d)>_geo.c.f.Math.Hc){this.Yw.lb(b,d);m.Mj(b,d,this.BG);for(var b=null,e=0;e<this.wa.Qe.length;++e)this.wa.Qe[e].offset(this.Yw),this.wa.Qe[e].HDc(b),b=this.wa.Qe[e];b=this.wa.dD.oca();for(e=0;e<b.length;++e){var f=b[e];f.Mr.uva+=d;this.BG.yb(f.Mr.pV,f.Mr.pV)}}this.mf=this.wa.mf=a};b.prototype.zrb=function(){return this.mf};return b}();
_geo.c.hd.qgb=function(){function b(a){_geo.c.hd.Ixa.call(this);this.pa=_geo.c.Ja(a,{joinSegments:!0,scaleWidth:!1,minWidth:-window.Infinity,maxWidth:window.Infinity,widthScaleX:1,widthScaleY:1,approxThreshold:.5});this.pa.approxThresholdMd=void 0!==this.pa.approxThresholdMd?this.pa.approxThresholdMd:this.pa.approxThreshold}_geo.c.na(b,_geo.c.hd.Ixa);_geo.c.ja(b,"geotoolkit.deviation.PiecewiseTransformer");b.prototype.xb=function(){return _geo.c.Ja(this.pa,{})};b.prototype.bb=function(a){_geo.c.Ja(a,
this.pa);return this};b.prototype.create=function(a,b){return new _geo.c.hd.Fjc(a,this.pa,b)};return b}();
_geo.c.hd.thb=function(){function b(b,e,d,f,h,l){if(!b||1>b.length||!e||1>e.length||b.length!==e.length)throw Error();var k;if(!d)for(d=[0],k=1;k<b.length;k++){var m=b[k]-b[k-1],q=e[k]-e[k-1];d.push(d[k-1]+Math.sqrt(m*m+q*q))}this.dk=[b[0]];this.al=[e[0]];this.WNb=[d[0]];for(k=1;k<d.length;k++)d[k]-d[k-1]<a||(this.dk.push(b[k]),this.al.push(e[k]),this.WNb.push(d[k]));this.pr=void 0!==f?f:Math.min.apply(null,d);this.or=void 0!==h?h:Math.max.apply(null,d);this.EJc=void 0!==l?l:!0;this.Fza=Math.min.apply(null,
b);this.wza=Math.max.apply(null,b);this.Gza=Math.min.apply(null,e);this.xza=Math.max.apply(null,e)}var a=.001;_geo.c.ja(b,"geotoolkit.deviation.Trajectory2d");b.prototype.ga=function(a){return this.dk[a]};b.prototype.ea=function(a){return this.al[a]};b.prototype.Lc=function(a){return this.WNb[a]};b.prototype.count=function(){return this.dk?this.dk.length:0};b.prototype.mj=function(){return this.pr};b.prototype.bj=function(){return this.or};b.prototype.ixc=function(a,b,d){return new _geo.c.hd.Ejc(this,
a,new _geo.c.f.sa(d,b))};b.qtc=function(a,e,d,f,h,l,k){if(!a||!e||a.length!==e.length)return null;for(d=0;d<a.length-1;++d)if(a[d+1]<a[d])return null;var m=new _geo.c.f.sa,q=new _geo.c.f.sa,p=new _geo.c.f.sa;l=void 0!==l?l:!0;k=void 0!==k?k:!0;var u=a.length,t=[],r=[],n=[];h=h||0;var v=a[0],w,x,y,B,A=0;for(d=0;d<u;d++){var C=f?e[d]:-e[d];if(0===d)t[0]=h,r[0]=v,n[0]=a[d],y=C,x=a[d],w=a[d];else{B=a[d]-n[A];h+=B*Math.sin(Math.PI*y/180);v+=B*Math.cos(Math.PI*y/180);if(l){if(0<=A){m.lb(t[A-1],r[A-1]);
q.lb(t[A],r[A]);p.lb(h,v);y=_geo.c.f.sa.Jm(q,p);var D=y<_geo.c.f.Math.Hc,E=0<A&&!D&&_geo.c.hd.gc.v4b(m,q,p);D||(E?(D=_geo.c.f.sa.Jm(m,q),(B=Math.abs(y/D-B/(n[A]-n[A-1]))<_geo.c.f.Math.Hc)||++A):++A,t[A]=h,r[A]=v,n[A]=a[d])}}else++A,t[A]=h,r[A]=v,n[A]=a[d];y=C;n[A]>x&&(x=n[A]);n[A]<w&&(w=n[A])}}return 0<A?new b(t,r,n,w,x,k):null};b.prototype.Qtb=function(){return this.Fza};b.prototype.Rtb=function(){return this.Gza};b.prototype.Ltb=function(){return this.wza};b.prototype.Mtb=function(){return this.xza};
return b}();
_geo.c.V.jma=function(){function b(){_geo.c.V.Yj.call(this);this.Vb=this.$H=this.FB=null;this.Lga=new _geo.c.f.sa}_geo.c.na(b,_geo.c.V.Yj);_geo.c.ja(b,"geotoolkit.scene.DeviatedCompositeNode");b.EGc=!1;b.aa={Ceb:"onDeviationChanged"};b.prototype.addListener=function(a,b){this.tb(a,b);return this};b.prototype.removeListener=function(a,b){this.pb(a,b);return this};b.prototype.Axb=function(){this.Pa(_geo.c.V.jma.aa.Ceb,this)};b.prototype.Mua=function(a){null==a?this.FB=null:(this.FB||(this.FB=new _geo.c.Sa.kma),
this.FB.Mua(a));this.Axb();this.Qa();this.ma();return this};b.prototype.yL=function(){return this.FB?this.FB.yL():null};b.prototype.va=function(){var a=this.yL();if(!a)return null;var b=a.trackWidth,a=a.trajectory;return new _geo.c.f.Rect(0,a.mj(),b,a.bj())};b.prototype.ha=function(){return this.Vb?this.Vb.ii():this.Y8a()};b.prototype.Ga=function(a){if(null!=this.Vb&&this.Vb.Ij(a))return this;this.xi();this.Vb!==a&&(this.Vb=null!=a?new _geo.c.f.Rect(a):a);this.Qa();this.xi();return this};b.prototype.Y8a=
function(){var a=this.yL();if(!a)return null;a=a.trajectory;return new _geo.c.f.Rect(a.Qtb(),a.Rtb(),a.Ltb(),a.Mtb())};b.prototype.Qa=function(a,b){_geo.c.V.Yj.prototype.Qa.call(this,a,b);this.$H=null;return this};b.prototype.ae=function(){if(null!=this.$H)return this.$H;var a=this.ha(),b=this.Y8a();null==a||a.Jd()||null==b||b.Jd()||(this.$H=_geo.c.f.Fa.Sf(b,a,!1,!1,!1));return this.$H};b.prototype.ydc=function(a){var b=this.FB,e=[];a=[a.pi(),new _geo.c.f.sa(a.ya(),a.ta()),a.Do(),new _geo.c.f.sa(a.ua(),
a.xa())];b.qj.BF(a,e,b.mf,!0);return _geo.c.f.Rc.yj(e)};b.prototype.xi=function(a,b){if(!this.FB||!this.FB.Ge)return this;var e=this.getParent();if(e){var d;a?(d=this.ydc(a),d=this.FB.qj.mf.xe(d)):d=e.va();e.ma(d,b)}if(this.mt)for(e=0;e<this.mt.length;++e)if(d=this.mt[e])if("function"==typeof d)d.call(this,a,b);else d.onInvalidate(a,b);return this};b.prototype.Ff=function(a){if(!this.ob())return!1;var b=this.ha();if(null!=b){var e=this.kc();null!=e&&(b=e.yb(b));b=a.$a().yb(b);e=this.yL();null!=e&&
null!=e.trackWidth&&b.de(e.trackWidth);if(!a.Ye().Wd(b))return!1}return!0};b.prototype.Aa=function(a){if(this.yL()){var g=null!=this.sb()?a.Qc(this.sb()):a;g.save();this.FB.update(g);var e=g.Ye(),d=g.$a().xe(e),d=this.FB.q6a(d);if(d.Jd())g.restore();else{if(this.FB.yL().clip){var f=this.ydc(d),f=f.Nd(e);g.Ji(f)}this.FB.Vab(d);for(e=this.fk();e.$g();)d=e.next(),this.FB.filter(d)&&(a.Sd()&&this.FB.Mm(d),d.Aa(this.FB));g.restore();b.EGc&&this.FB.avc(new _geo.c.attributes.za("red",2))}}else _geo.c.V.Yj.prototype.Aa.call(this,
a)};b.prototype.SXb=function(a,b){if(null==this.FB)return null;this.FB.qdb(this.Za());var e=this.FB.q6a(a);if(e.Jd())return null;b?b.qk(e.ta(),e.xa()):b=new _geo.c.f.Range(e.ta(),e.xa());return b};return b}();
_geo.c.Sa.kma=function(){function b(a){_geo.c.Sa.jP.call(this);this.mf=null!=a?a:new _geo.c.f.Fa;this.H3a=null;this.pa={};this.pa.trajectory=null;this.pa.transformer=new _geo.c.hd.qgb;this.pa.trackWidth=100;this.pa.offset=0;this.pa.clip=!0;this.qj=this.Ge=null;this.wa=[];this.EG=new _geo.c.f.Fa;this.Lga=new _geo.c.f.sa;this.Vna=this.Una=window.NaN;this.Qya=this.Zk=null;this.fv=[0,0,0,0];this.Upa=[];this.FW=this.$o=this.uE=null}var a=function(){function a(b,d){this.Gg=b;this.Eh=d;this.Vb=new _geo.c.f.Rect(0,
0,this.Gg,this.Eh);this.b1a=new _geo.c.Sa.canvas.Fr(this.Gg,this.Eh,!0);this.HS=this.b1a.HI(this.Gg,this.Eh);this.A0a=!0;var e=new _geo.c.f.JV;this.Zoa=e.isIOS||e.isSafari}a.prototype.ba=function(){return this.Gg};a.prototype.da=function(){return this.Eh};a.prototype.clear=function(){if(null==this.HS)return this;for(var a=this.HS.getData(),b=4*this.HS.ba()*this.HS.da(),d=0;d<b;d++)a[d]=0;this.Zoa&&this.b1a.clear();return this};a.prototype.mq=function(){!1===this.A0a&&this.clear();this.A0a=!0;return this};
a.prototype.Hp=function(){this.b1a.BJ(this.HS,0,0)};a.prototype.Sbb=function(a,b,d){this.A0a=!1;var e=this.HS.getData();a=4*(b*this.Gg+a);e[a+0]=d[0];e[a+1]=d[1];e[a+2]=d[2];e[a+3]=d[3]};a.prototype.Lo=function(a,b){this.Vb.zb(a).Eb(b);return this};a.prototype.ha=function(){return this.Vb};a.prototype.Aa=function(a,b,d){if(!0===this.A0a)return this;d.drawImage(this.b1a,0,0,this.Gg,this.Eh,a,b,this.Gg,this.Eh);return this};return a}(),g=function(){function a(b,d){this.NE=b;this.Vb=d;this.Ef=Math.ceil(d.ba()/
b.ba());this.Yi=Math.ceil(d.da()/b.da())}a.prototype.hRa=function(){return this.Yi};a.prototype.$Pa=function(){return this.Ef};a.prototype.oyc=function(a,b){var d=this.Vb.ua()+a*this.NE.ba(),e=this.Vb.ta()+b*this.NE.da();return this.NE.Lo(d,e)};return a}(),e=_geo.c.f.sa,d=new e(0,0),f=new e(0,0),h=new e(0,0),l=new e(0,0);_geo.c.na(b,_geo.c.Sa.jP);b.prototype.ur=function(){if(!this.Ge)throw Error("Parent rendering context is not defined");};b.prototype.Mua=function(a){_geo.c.Ja(a,this.pa);this.qj&&
this.pa.transformer&&(a=this.EG,"function"==typeof this.qj.zrb&&(a=this.qj.zrb()),this.qj=this.pa.transformer.create(this.pa,a))};b.prototype.yL=function(){return this.pa};b.prototype.F7a=function(){return this.qj?_geo.c.Ja(this.qj.Gub(),{}):{}};b.prototype.E1b=function(){return this.Ge};b.prototype.update=function(a){this.qdb(a.$a());this.Ge=a;this.Lka(this.Ge?this.Ge.JQ():null)};b.prototype.qdb=function(a){a&&(this.qj?this.qj.update(a):this.qj=this.pa.transformer.create(this.pa,a));this.mf.gGa()};
b.prototype.Qc=function(a){a=_geo.c.f.Fa.multiply(this.mf,a);a=new b(a);a.Mua(this.yL());a.Lka(this.JQ());a.Vab(this.uE);this.Ge.Mm(this.FW);a.qj=this.qj;a.Ge=this.Ge;return a};b.prototype.$a=function(){return this.mf};b.prototype.sc=function(a){this.mf=a;this.$o=this.H3a=null;return this};b.prototype.rq=function(){null==this.H3a&&(this.H3a=this.mf.me());return this.H3a};b.prototype.mx=function(){this.ur();return this.Ge.mx()};b.prototype.hb=function(a){return this.qj.transform(a,this.mf)};b.prototype.uZ=
function(a,b,d){d||(d=[]);this.qj.BF([a,b],d,this.mf);return d};b.prototype.xc=function(a,b,e,g){a instanceof _geo.c.f.Rect?(d.lb(a.ua(),a.ta()),f.lb(a.ua()+a.ba(),a.ta()+a.da())):(d.lb(a,b),f.lb(a+e,b+g));a=[d.ga(),f.ga(),f.ga(),d.ga(),d.ga()];b=[d.ea(),d.ea(),f.ea(),f.ea(),d.ea()];this.Kk(a,b);return this};b.FHb=new a(256,256);b.prototype.kab=function(a,b,e,f,h,k,l,m,p,q){if(l===p||m===q)return this;var C=null;"function"===typeof this.Zk.cF&&(null!=this.Qya&&(e=this.Qya.ua(),f=this.Qya.ta(),h=this.Qya.ya(),
k=this.Qya.xa()),C=this.Zk.cF(e,f,h,k));if(!C)return this;e=1;f=[];h=[];if(1!==e)for(l*=e,m*=e,p*=e,q*=e,k=0;k<a.length;++k)f.push(a[k]*e),h.push(b[k]*e);else f=a,h=b;l=Math.floor(l);m=Math.floor(m);p=Math.ceil(p);q=Math.ceil(q);if(0>l+(p-l+1)||0>m+(q-m+1))return this;l=new _geo.c.f.Rect(l,m,p,q);(b=this.Ge.Ye().clone())&&1!==e&&b.Tb(b.ua()*e,b.ta()*e,b.ya()*e,b.xa()*e);if(!1===l.Wd(b))return this;l.Nd(b);if(l.Jd())return this;l.Tb(Math.floor(l.ua()),Math.floor(l.ta()),Math.ceil(l.ya()),Math.ceil(l.xa()));
a=l.da();q=this.mf.me();if(f[0]!==f[f.length-1]||h[0]!==h[h.length-1])f.push(f[0]),h.push(h[0]);k=[{}];var D=new g(_geo.c.Sa.kma.FHb,l),E=_geo.c.Sa.kma.FHb.ba(),F=this.Ge.$a();this.Ge.sc(_geo.c.f.Fa.XV);for(var J=0;J<D.hRa();J++)for(var H=0;H<D.$Pa();H++){var G=D.oyc(H,J),K=G.ha();if(null==b||!1!==b.Wd(G.ha())){G.mq();l=G.ha().ua();m=G.ha().ta();p=G.ha().ya();G.ha().xa();for(var M=0;M<a;++M){var O=m+M;if(!b||!(O<b.ta()||O>b.xa()))for(var L=_geo.c.hd.gc.hwc(f,h,O,k),N=0;N<L.length;++N){var I=L[N];
if(!(1>I.Hg-I.Bc)){var Q=Math.floor(I.Bc);Q<l&&(Q=l);var S=Math.ceil(I.Hg);S>p&&(S=p);for(var P=Math.ceil(I.Bc)-I.Bc,I=I.Hg-Math.floor(I.Hg),R=Q;R<=S;++R){var V=R-l;if(!(0>V||V>=K.ba()||0>M||M>=K.da()||b&&!b.contains(R,O))){d.lb(R/e,O/e);var U=this.qj.te(d);(0,window.isNaN)(U.ga())||(0,window.isNaN)(U.ea())||(q.hb(U,U),C.mo(U.ga(),U.ea(),this.fv),R===Q&&0!==V?this.fv[3]=Math.round(P*this.fv[3]):R===S&&V!==E&&(this.fv[3]=Math.round(I*this.fv[3])),G.Sbb(V,M,this.fv))}}}}}G.Hp();G.Aa(l/e,m/e,this.Ge)}}this.Ge.sc(F);
return this};b.prototype.Puc=function(){var a=_geo.c.V.$.fn.j1(_geo.c.f.Rect.iz,this.FW.nw()),b=a.ga(),a=a.ea(),d=this.qj.transform(new e(b,a),this.mf),b=d.ga(),a=d.ea(),f=this.qj.te(d);this.Lga.lb(0,f.ea());d=this.qj.transform(this.Lga,this.EG);this.Lga.lb(this.pa.trackWidth,f.ea());var f=this.qj.transform(this.Lga,this.EG),g=Math.atan2(f.ea()-d.ea(),f.ga()-d.ga()),d=0>this.mf.Rb(),f=0>this.mf.hc(),g=_geo.c.f.Fa.hp(g,0,0),a=_geo.c.f.Fa.Mj(b,a),b=new _geo.c.f.Fa;d||f?(b.scale(d?-1:1,f?-1:1),_geo.c.f.Fa.multiply(g,
b,b),_geo.c.f.Fa.multiply(a,b,b)):_geo.c.f.Fa.multiply(a,g,b);a=this.Ge.$a();this.Ge.sc(b);b=this.FW.Zi();this.FW.Tg(!1);this.FW.Ic(0,0);this.FW.Aa(this.Ge);this.FW.Ic(b);this.FW.Tg(!0);this.Ge.sc(a)};b.prototype.Kk=function(a,b,d,f){this.ur();if(!this.pa.trajectory)return this;if(this.FW&&this.FW instanceof _geo.c.V.$.fn&&this.FW.ZG())return this.Puc(),this;var g,h,k=Math.min(a.length,b.length),l=[];f=d=Number.POSITIVE_INFINITY;var m=Number.NEGATIVE_INFINITY,p=Number.NEGATIVE_INFINITY,q;for(q=0;q<
k;++q)g=a[q],h=b[q],g<d&&(d=g),h<f&&(f=h),g>m&&(m=g),h>p&&(p=h),l.push(new e(a[q],b[q]));d=Math.floor(d);f=Math.floor(f);m=Math.ceil(m);p=Math.ceil(p);this.wa=[];this.qj.BF(l,this.wa,this.mf,!0);a=[];b=[];var l=k=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(q=0;q<this.wa.length;++q)g=this.wa[q].ga(),h=this.wa[q].ea(),g<k&&(k=g),h<l&&(l=h),g>D&&(D=g),h>E&&(E=h),a.push(g),b.push(h);if(a[a.length-1]!==a[0]||b[b.length-1]!==b[0])a.push(a[0]),b.push(b[0]);g=0;h=a.length-
1;this.wa=[];q=this.Ge.$a();this.Ge.sc(this.EG);this.Zk&&this.kab(a,b,d,f,m,p,k,l,D,E);this.Ge.Kk(a,b,g,h);this.Ge.sc(q);return this};b.prototype.Fm=function(a,b,d,f){this.ur();if(!this.pa.trajectory)return this;void 0===d&&(d=0,f=Math.min(a.length,b.length)-1);if(f<=d)return this;for(var g=[];d<=f;++d)g.push(new e(a[d],b[d]));this.wa=[];this.qj.BF(g,this.wa,this.mf,!1);a=[];b=[];for(d=0;d<this.wa.length;++d)a.push(this.wa[d].ga()),b.push(this.wa[d].ea());d=0;f=a.length-1;this.wa=[];g=this.Ge.$a();
this.Ge.sc(this.EG);this.Ge.Fm(a,b,d,f);this.Ge.sc(g);return this};b.prototype.avc=function(a){var b=this.yL().tPc;this.Ge.Ba(a);this.Ge.Fm(b.dk,b.al,0,b.dk.length-1)};b.prototype.Id=function(a,b,e,g){this.ur();if(!this.pa.trajectory)return this;d.lb(a,b);f.lb(e,g);this.wa=[];this.qj.BF([d,f],this.wa,this.mf);a=[];b=[];for(e=0;e<this.wa.length;++e)a.push(this.wa[e].ga()),b.push(this.wa[e].ea());e=0;g=a.length-1;this.mEb([d,f],this.wa);this.wa=[];var h=this.Ge.$a();this.Ge.sc(this.EG);this.Ge.Fm(a,
b,e,g);this.Ge.sc(h);return this};b.prototype.r4a=function(a,b,e,g){d.lb(a.tDa(),a.wDa());f.lb(a.uDa(),a.xDa());h.lb(a.vDa(),a.yDa());l.lb(a.Nsa(),a.Osa());a=_geo.c.f.Math.Lqa(d,f,h,l);this.wa=[];this.qj.BF(a,this.wa,this.mf,!1);for(a=0;a<this.wa.length;++a){var k=this.wa[a].ga(),m=this.wa[a].ea();k<g.tB&&(g.tB=k);m<g.vB&&(g.vB=m);k>g.sB&&(g.sB=k);m>g.uB&&(g.uB=m);b.push(k);e.push(m)}};b.prototype.xn=function(a,b,d,e){this.ur();if(!this.pa.trajectory)return this;var f=a,g=b,h=a+d,k=b+e;e=_geo.c.Sa.gc.tia(a+
d/2,b+e/2,d,e);a=[];b=[];d={tB:Number.POSITIVE_INFINITY,vB:Number.POSITIVE_INFINITY,sB:Number.NEGATIVE_INFINITY,uB:Number.NEGATIVE_INFINITY};for(var l=0;l<e.length;++l)this.r4a(e[l],a,b,d);e=this.Ge.$a();this.Ge.sc(this.EG);this.Zk&&this.kab(a,b,f,g,h,k,d.tB,d.vB,d.sB,d.uB);this.Ge.Kk(a,b);this.Ge.sc(e);return this};b.prototype.cp=function(a,b,d,f,g,k,l,m,p){this.ur();if(!this.pa.trajectory)return this;if(k-g>=2*Math.PI)return this.xn(a,b,d,f),this;var q=a,C=b,D=a+d,E=b+f;a+=d/2;b+=f/2;l=[];var F=
[];if(!m){var J=this.qj.transform(new e(a,b),this.mf);l.push(J.ga());F.push(J.ea())}a=_geo.c.Sa.gc.tia(a,b,d,f,g,k);if(1>a.length)return this;b={tB:Number.POSITIVE_INFINITY,vB:Number.POSITIVE_INFINITY,sB:Number.NEGATIVE_INFINITY,uB:Number.NEGATIVE_INFINITY};for(d=0;d<a.length;++d)this.r4a(a[d],l,F,b);a=this.Ge.$a();this.Ge.sc(this.EG);if(m)if(p)for(m=0;m<l.length;++m)p=h.lb(l[m],F[m]),this.Ge.lineTo(p.ga(),p.ea());else this.Ge.Fm(l,F);else this.Ge.Kk(l,F);this.Ge.sc(a);if(this.Zk){this.rab();this.aG=
{tB:q,vB:C,sB:D,uB:E};for(q=0;q<l.length;++q){C=Math.round(l[q]);D=Math.round(F[q]);E=this.k6.length;if(0===E||this.k6[E-1]!==C&&this.rha[E-1]!==D)this.k6.push(C),this.rha.push(D);l[q]<this.Qx.tB&&(this.Qx.tB=l[q]);F[q]<this.Qx.vB&&(this.Qx.vB=F[q]);l[q]>this.Qx.sB&&(this.Qx.sB=l[q]);F[q]>this.Qx.uB&&(this.Qx.uB=F[q])}this.Ge.sc(this.EG);this.kab(this.k6,this.rha,this.aG.tB,this.aG.vB,this.aG.sB,this.aG.uB,this.Qx.tB,this.Qx.vB,this.Qx.sB,this.Qx.uB);this.rab();this.Ge.sc(a)}return this};b.prototype.sv=
function(a,b,d,e,f,g){this.ur();if(!this.pa.trajectory)return this;var h=g-f>=2*Math.PI;h&&(f=0,g=2*Math.PI);d=_geo.c.Sa.gc.tia(a,b,2*d,2*d,f,g);a=_geo.c.Sa.gc.tia(a,b,2*e,2*e,f,g,!0);if(h){this.beginPath();b=d[0];this.moveTo(b.tDa(),b.wDa());for(h=0;h<d.length;++h)b=d[h],this.bezierCurveTo(b.uDa(),b.xDa(),b.vDa(),b.yDa(),b.Nsa(),b.Osa());b=a[a.length-1];this.moveTo(b.Nsa(),b.Osa());for(h=a.length-1;0<=h;--h)b=a[h],this.bezierCurveTo(b.vDa(),b.yDa(),b.uDa(),b.xDa(),b.tDa(),b.wDa());this.closePath();
this.Ge.Wh();this.Ge.stroke()}else{b=[];e=[];f={tB:Number.POSITIVE_INFINITY,vB:Number.POSITIVE_INFINITY,sB:Number.NEGATIVE_INFINITY,uB:Number.NEGATIVE_INFINITY};for(h=0;h<d.length;++h)this.r4a(d[h],b,e,f);for(h=0;h<a.length;++h)this.r4a(a[h],b,e,f);d=this.Ge.$a();this.Ge.sc(this.EG);this.Ge.Kk(b,e);this.Ge.sc(d)}return this};var k=new _geo.c.f.If([],[]),m=new _geo.c.f.If([],[]),q=_geo.c.JI.kw(100,100),p=!1;b.prototype.drawImage=function(a,b,g,n,v,w,x,y,B){"function"===typeof a.Lk&&(a=a.Lk());void 0===
n&&(n=a.width,v=a.height,w=b,x=g,y=n,B=v,g=b=0);var A=this.mf.transform(new _geo.c.f.Rect(w,x,w+y,x+B)),C=Math.ceil(A.ba()),D=Math.ceil(A.da());if(0!==C&&0!==D){var E=Math.ceil(A.ya()),F=Math.ceil(A.xa());q.width=E;q.height=F;E=q.getContext("2d");E.setTransform(this.mf.xf,this.mf.qg,this.mf.Ag,this.mf.Wf,this.mf.Qi,this.mf.Fi);E.drawImage(a,b,g,n,v,w,x,y,B);a=E.getImageData(Math.floor(A.ua()),Math.floor(A.ta()),C,D).data;E.setTransform(1,0,0,1,0,0);var A=this.mf.transform(new e(w,x),d),F=this.mf.transform(new e(w+
y,x),f),J=this.mf.transform(new e(w,x+B),h),H=this.mf.transform(new e(w+y,x+B,l));w=new _geo.c.f.If([A.x,F.x,H.x,J.x],[A.y,F.y,H.y,J.y]);this.qj.BF([A,F,H,J],this.wa,this.EG,!0);if(3>this.wa.length)this.wa=[];else{x=[];y=[];var G=window.Infinity;B=window.Infinity;g=b=-window.Infinity;for(n=0;n<this.wa.length;++n){v=this.wa[n].ga();var K=this.wa[n].ea();v<G&&(G=v);K<B&&(B=K);v>b&&(b=v);K>g&&(g=K);x.push(v);y.push(K)}this.wa=[];n=new _geo.c.f.Jf;n.zi(k.hl(x,y),n);v=Math.min(A.x,F.x,J.x,H.x);A=Math.min(A.y,
F.y,J.y,H.y);G=Math.floor(G);B=Math.floor(B);b=Math.ceil(b);g=Math.ceil(g);var F=Math.min(100,Math.max(b-G,g-B)),M,O,L,N;q.width=F;q.height=F;J=this.Ge.$a();for(this.Ge.sc(this.EG);G<b;G+=F)for(H=B;H<g;H+=F){K=E.createImageData(F,F);M=Math.min(G+F,b);N=Math.min(H+F,g);m.hl([G,M,M,G],[H,H,N,N]);var I=n.Nd(m);if(I.length){O=window.Infinity;M=N=-window.Infinity;L=window.Infinity;for(var Q=0;Q<I.length;Q++)O=Math.min(O,Math.min.apply(null,I[Q].dg())),M=Math.max(M,Math.max.apply(null,I[Q].dg())),N=Math.max(N,
Math.max.apply(null,I[Q].Yg())),L=Math.min(L,Math.min.apply(null,I[Q].Yg()));I=!1;for(O=Math.floor(O);O<Math.ceil(M);++O)for(Q=Math.floor(L);Q<Math.ceil(N);++Q){var S=0,P=0,R=0,V=0,U=d.lb(O,Q),pa=O-G,Z=Q-H,ba=this.qj.te(U,f),fa=h.lb(_geo.c.hd.gc.dO(ba.ga()-v),_geo.c.hd.gc.dO(ba.ea()-A));if(w.contains(ba.ga(),ba.ea())&&(ba=this.qj.$0(U,1))){for(var ma=U=0;ma<ba.cc();++ma){var ha=ba.get(ma),X=fa.x+ha.Qi,ca=fa.y+ha.Fi;0>X||0>ca||X>=C||ca>=D||(X=4*(X+ca*C),S+=a[X++]*ha.qOa,P+=a[X++]*ha.qOa,R+=a[X++]*
ha.qOa,V+=a[X]*ha.qOa,U+=ha.qOa)}V<_geo.c.f.Math.Hc||0===U||(I=4*(pa+Z*F),K.data[I++]=S/U,K.data[I++]=P/U,K.data[I++]=R/U,K.data[I]=V/U,I=!0)}}if(p)for(M=0;M<F;M++)L=4*M,K.data[L]=0,K.data[L+1]=0,K.data[L+2]=0,K.data[L+3]=255,L=F*M*4,K.data[L]=0,K.data[L+1]=0,K.data[L+2]=0,K.data[L+3]=255,L=4*(F*(F-1)+M),K.data[L]=0,K.data[L+1]=0,K.data[L+2]=0,K.data[L+3]=255,L=4*(F*M+F-1),K.data[L]=0,K.data[L+1]=0,K.data[L+2]=0,K.data[L+3]=255;I&&(E.clearRect(0,0,F,F),E.putImageData(K,0,0),this.Ge.drawImage(q,G,
H))}}p&&(this.Ge.Ba(new _geo.c.attributes.za("blue")),this.Ge.Kk(x,y,0,x.length));this.Ge.sc(J)}}};b.prototype.be=function(a,b,d){this.ur();if(!this.pa.trajectory)return this;var f=this.qj.transform(new e(a,b),this.mf);b=this.qj.transform(new e(a+1,b),this.mf);a=this.Ge.$a();b=Math.atan2(b.ea()-f.ea(),b.ga()-f.ga());b=_geo.c.f.Fa.hp(b,f.ga(),f.ea());this.Ge.sc(b);this.Ge.be(f.ga(),f.ea(),d);this.Ge.sc(a);return this};b.prototype.beginPath=function(){this.ur();if(!this.pa.trajectory)return this;this.rab();
this.Ge.beginPath();return this};b.prototype.moveTo=function(a,b){this.ur();if(!this.pa.trajectory)return this;this.vNb=a;this.wNb=b;this.Una=a;this.Vna=b;d.lb(a,b);d=this.qj.transform(d,this.mf);var e=this.Ge.$a();e.Ie(d,d);this.Ge.moveTo(d.ga(),d.ea());return this};b.prototype.rab=function(){this.aG={tB:Number.POSITIVE_INFINITY,vB:Number.POSITIVE_INFINITY,sB:Number.NEGATIVE_INFINITY,uB:Number.NEGATIVE_INFINITY};this.Qx={tB:Number.POSITIVE_INFINITY,vB:Number.POSITIVE_INFINITY,sB:Number.NEGATIVE_INFINITY,
uB:Number.NEGATIVE_INFINITY};this.k6=[];this.rha=[]};b.prototype.mEb=function(a,b){if(this.Zk&&this.aG){var d=_geo.c.f.Rc.yj(a);d.ua()<this.aG.tB&&(this.aG.tB=d.ua());d.ta()<this.aG.vB&&(this.aG.vB=d.ta());d.ya()>this.aG.sB&&(this.aG.sB=d.ya());d.xa()>this.aG.uB&&(this.aG.uB=d.xa());d=_geo.c.f.Rc.yj(b);d.ua()<this.Qx.tB&&(this.Qx.tB=d.ua());d.ta()<this.Qx.vB&&(this.Qx.vB=d.ta());d.ya()>this.Qx.sB&&(this.Qx.sB=d.ya());d.xa()>this.Qx.uB&&(this.Qx.uB=d.xa());this.k6||(this.k6=[]);this.rha||(this.rha=
[]);for(d=0;d<b.length;++d){var e=b[d].ga(),f=b[d].ea(),g=this.k6.length;1<g&&this.k6[g-1]===e&&this.rha[g-1]===f||(this.k6.push(e),this.rha.push(f))}}};b.prototype.lineTo=function(a,b){this.ur();if(!this.pa.trajectory)return this;var e=d.lb(this.Una,this.Vna),g=f.lb(a,b);this.wa=[];this.qj.BF([e,g],this.wa,this.mf,!1);for(var k=this.Ge.$a(),l=0;l<this.wa.length;++l){var m=h.lb(this.wa[l].ga(),this.wa[l].ea());k.Ie(m,m);this.Ge.lineTo(m.ga(),m.ea())}this.mEb([e,g],this.wa);this.wa=[];this.Una=a;this.Vna=
b;return this};b.prototype.arcTo=function(a,b,d,e,f){this.ur();if(!this.pa.trajectory)return this;a=_geo.c.hd.gc.GVb(this.Una,this.Vna,a,b,d,e,f);this.lineTo(a.aB.Jec,a.aB.Lec);this.Una=a.ep.x;this.Vna=a.ep.y;a=a.arc;this.cp(a.left,a.top,2*f,2*f,a.um,a.WE,void 0,!0,!0);return this};b.prototype.bezierCurveTo=function(a,b,e,g,k,m,p){this.ur();if(!this.pa.trajectory)return this;this.wa=[];d.lb(this.Una,this.Vna);f.lb(a,b);h.lb(e,g);l.lb(k,m);a=_geo.c.f.Math.Lqa(d,f,h,l);this.qj.BF(a,this.wa,this.mf,
!1);b=this.Ge.$a();this.Ge.sc(this.EG);for(e=0;e<this.wa.length;++e)this.Ge.lineTo(this.wa[e].ga(),this.wa[e].ea());this.Ge.sc(b);this.mEb(a,this.wa);this.wa=[];this.Una=k;this.Vna=m;return this};b.prototype.stroke=function(){this.ur();if(!this.pa.trajectory)return this;this.Ge.stroke();return this};b.prototype.closePath=function(){this.ur();if(!this.pa.trajectory)return this;void 0!==this.vNb&&void 0!==this.wNb&&this.lineTo(this.vNb,this.wNb);this.Ge.closePath();return this};b.prototype.Wh=function(){this.ur();
this.Zk&&!1===this.Sd()?(this.kab(this.k6,this.rha,this.aG.tB,this.aG.vB,this.aG.sB,this.aG.uB,this.Qx.tB,this.Qx.vB,this.Qx.sB,this.Qx.uB),this.rab()):this.Ge.Wh();return this};b.prototype.Ob=function(a){this.ur();if(!this.pa.trajectory)return this;this.Ge.Ob(a);return this};b.prototype.getParent=function(){this.ur();return this.Ge.getParent()};b.prototype.pk=function(){this.ur();return this.Ge.pk()};b.prototype.ky=function(){this.ur();return this.Ge?this.Ge.ky():null};b.prototype.lw=function(a,
b,d){this.ur();return new _geo.c.Sa.Beb(a,b,d)};b.prototype.Vab=function(a){this.Bw(a);return this};b.prototype.Bw=function(a){this.uE=null!=a?a.clone():null;this.ww=null};b.prototype.Ry=function(a){if(null!=a){var b=this.$a();null!=b&&(a=b.yb(a));this.Bw(a)}};b.prototype.Ye=function(){return null==this.uE?new _geo.c.f.Rect(0,this.pa.trajectory.mj(),this.pa.trackWidth,this.pa.trajectory.bj()):this.uE instanceof _geo.c.f.Rect?this.uE:this.uE.ha()};b.prototype.zk=function(){null==this.$o&&(this.$o=
this.rq().yb(this.Ye()));return this.$o};b.prototype.mta=function(a,b,d){this.wa=[];this.qj.BF(a,this.wa,this.EG,d);if(!(1>this.wa.length)){d&&(a=this.wa[0],b.moveTo(a.ga(),a.ea()));for(var e=1;e<this.wa.length;++e)a=this.wa[e],b.lineTo(a.ga(),a.ea());d&&b.close();this.wa=[]}};b.prototype.Ji=function(a,b,g){a instanceof _geo.c.f.Jf&&(a=a.dsa());if(!this.pa.clip)return this;this.ur();b=void 0!==b?b:_geo.c.Sa.Gw.Ox;null!=a&&void 0!==g&&g&&!this.$a().xD()&&this.$a().transform(a,a);this.Vab(_geo.c.f.Rc.rSa(this.uE,
a,b));g=null;null==this.uE?(a=this.pa.trajectory,g=new _geo.c.f.Rect(0,a.mj(),this.pa.trackWidth,a.bj())):g=this.uE;a=new _geo.c.Sa.yf;if(g instanceof _geo.c.f.Rect)d.lb(g.ua(),g.ta()),f.lb(g.ya(),g.ta()),h.lb(g.ya(),g.xa()),l.lb(g.ua(),g.xa()),this.mta([d,f,h,l],a,!0);else if(g instanceof _geo.c.Sa.yf){b=g.aH();for(var k=g.ga(),m=g.ea(),p=new e,q=new e,y,B,A=0;A<b.length;A++){var C=g.bC(A);if(b[A]===_geo.c.Sa.yf.Vi.TF)p.lb(k[C],m[C]),q.lb(k[C],m[C]),y=this.qj.transform(p,this.EG),a.moveTo(y.ga(),
y.ea());else if(b[A]===_geo.c.Sa.yf.Vi.hK)d.lb(k[C],m[C]),this.mta([q,d],a),q.lb(k[C],m[C]);else if(b[A]===_geo.c.Sa.yf.Vi.QO)f.lb(k[C],m[C]),h.lb(k[C+1],m[C+1]),l.lb(k[C+2],m[C+2]),B=_geo.c.f.Math.Lqa(q,f,h,l),this.mta(B,a),q.lb(k[C+2],m[C+2]);else if(b[A]===_geo.c.Sa.yf.Vi.FZ){y=_geo.c.hd.gc.GVb(q.ga(),q.ea(),k[C],m[C],k[C+1],m[C+1],k[C+2]);B=y.aB;d.lb(B.eIc,B.fIc);q.lb(B.Jec,B.Lec);this.mta([d,q],a);B=y.arc;for(var C=k[C+2],C=_geo.c.Sa.gc.tia(B.left+C,B.top+C,2*C,2*C,B.um,B.WE),D,E=0;E<C.length;++E)D=
C[E],d.lb(D.tDa(),D.wDa()),f.lb(D.uDa(),D.xDa()),h.lb(D.vDa(),D.yDa()),l.lb(D.Nsa(),D.Osa()),B=_geo.c.f.Math.Lqa(d,f,h,l),this.mta(B,a);D&&q.lb(D.Nsa(),D.Osa());y=y.ep;d.lb(y.x,y.y);this.mta([q,d],a);q.lb(y.x,y.y)}else b[A]===_geo.c.Sa.yf.Vi.$R&&(this.mta([q,p],a),a.close())}}D=this.Ge.$a();this.Ge.sc(this.EG);this.Ge.Ji(a,_geo.c.Sa.Gw.Ox,!1);this.Ge.sc(D);return this};b.prototype.Sd=function(){return this.Ge?this.Ge.Sd():!1};b.prototype.measureText=function(a,b){this.ur();return this.Ge.measureText(a,
b)};b.prototype.save=function(){this.ur();var a=null!=this.uE?this.uE.clone():null;this.Upa.push(a);this.Ge.save();return this};b.prototype.restore=function(){this.ur();0<this.Upa.length&&this.Vab(this.Upa.pop());this.Ge.restore();return this};b.prototype.q6a=function(a){this.ur();return this.qj.sra(a)};b.prototype.Mm=function(a){this.ur();this.Ge.Mm(a);this.FW=a;return this};b.prototype.AI=function(){this.ur();this.Ge.AI();return this};b.prototype.LI=function(){this.ur();this.Ge.LI();return this};
b.prototype.ro=function(a){this.ur();this.Ge.ro(a);return this};b.prototype.Ea=function(a,b){this.ur();a?a instanceof _geo.c.attributes.Dj&&!1===this.Sd()?(this.Qya=b,this.Zk=a,this.Ge.Ea(null)):(this.Zk=null,this.Ge.Ea(a,b)):(this.Zk=null,this.Ge.Ea(a,b));return this};b.prototype.Bb=function(){this.ur();return this.Zk?this.Zk:this.Ge.Bb()};b.prototype.Ba=function(a,b){this.ur();this.Ge.Ba(a,b);return this};b.prototype.LZb=function(a,b){for(var d=0,e=this.uZ(a,b),f=0;f<e.length-1;++f)d+=_geo.c.f.sa.Jm(e[f],
e[f+1]);return d};return b}();
_geo.c.Sa.Beb=function(){function b(a,b,f){_geo.c.Sa.canvas.Fr.call(this,a,b,f)}var a=new _geo.c.f.Fa,g=new _geo.c.f.sa;_geo.c.na(b,_geo.c.Sa.canvas.Fr);b.prototype.Aa=function(b,d,f,h,l,k,m,q,p){if(!(b instanceof _geo.c.Sa.kma))throw Error("context must be instanceof geotoolkit.renderer.DeviatedRenderingContext");f=b.qj.transform(g.lb(d+this.ba()/2,f+this.da()/2),a);d=f.ga()-this.ba()/2;f=f.ea()-this.da()/2;return h||l?_geo.c.Sa.canvas.Fr.prototype.Aa.call(this,b.E1b(),d,f,h,l,k,m,q,p):_geo.c.Sa.canvas.Fr.prototype.Aa.call(this,
b.E1b(),d,f)};return b}();
_geo.c.hd.ia.lwa=function(){function b(a){_geo.c.controls.ia.oc.call(this,a);this.qj=this.Dya=null;this.Zc=this.$b instanceof _geo.c.V.Cg?this.$b.getParent():this.$b}_geo.c.na(b,_geo.c.controls.ia.oc);_geo.c.ja(b,"geotoolkit.deviation.tools.DeviationTool");b.prototype.iEc=function(){var a=this.Dya.yL(),b=this.Dya.Za();this.qj=a.transformer.create(a,b)};b.prototype.eCa=function(){if(null==this.Dya){var a=_geo.c.selection.Bc(this.$b.vf()).Ve(function(a){return a instanceof _geo.c.V.jma}).ZY();null!=
a&&0<a.length&&(this.Dya=a[0],this.Dya.addListener(_geo.c.V.jma.aa.Ceb,function(){this.iEc()}.bind(this)))}return this.Dya};return b}();
_geo.c.hd.ia.XIb=function(){function b(){_geo.c.V.Ya.call(this);this.rk(!1);this.Wx=new _geo.c.V.$.Jr;this.Ia(this.Wx);this.Wi=(new _geo.c.V.$.Text({textstyle:new _geo.c.attributes.kb})).xF(!0);this.Ia(this.Wi);this.TJa=0;this.Is(_geo.c.hd.uk.ub);this.UQb=null}_geo.c.na(b,_geo.c.V.Ya);b.prototype.ma=function(a,b){this.ob()&&(null==a?(this.Wi&&this.xi(this.Wi.ha(),b),this.Wx&&this.xi(this.Wx.ha(),b)):this.xi(a,b));return this};b.prototype.setData=function(a,b,e){this.UQb=e;this.Wx.Hv({from:a,to:b});
var d=Math.atan2(b.ea()-a.ea(),b.ga()-a.ga());a=this.E1a===_geo.c.hd.uk.ub?new _geo.c.f.sa((a.ga()+b.ga())/2,(a.ea()+b.ea())/2):this.E1a===_geo.c.hd.uk.De?new _geo.c.f.sa(a.ga(),a.ea()):new _geo.c.f.sa(b.ga(),b.ea());e=null!=this.Wi.Qna?this.Wi.Qna(e.ga(),e.ea()):e.toString();this.Wi.Ec(e);0!==this.TJa&&this.Wi.rotate(-this.TJa,this.Wi.LA(),this.Wi.my());this.Wi.Ic(a);this.TJa=d;0!==this.TJa&&this.Wi.rotate(this.TJa,this.Wi.LA(),this.Wi.my());return this};b.prototype.getData=function(){return this.UQb};
b.prototype.es=function(a){a&&(a.line&&this.RFc(a.line),a.label&&this.du(a.label));return this};b.prototype.RFc=function(a){void 0!==a.linestyle&&this.Wx.Ba(a.linestyle);null!=a.visible&&this.Wx.Ma(a.visible)};b.prototype.Is=function(a){this.E1a=a;this.E1a===_geo.c.hd.uk.ub?this.Wi.Ld(_geo.c.f.Ca.uj):this.E1a===_geo.c.hd.uk.De?this.Wi.Ld(_geo.c.f.Ca.Ej):this.Wi.Ld(_geo.c.f.Ca.Wk)};b.prototype.du=function(a){void 0!==a.textstyle&&this.Wi.Ob(a.textstyle);null!=a.visible&&this.Wi.Ma(a.visible);void 0!==
a.textconverter&&(this.Wi.Qna=a.textconverter);null!=a.position&&this.Is(a.position)};return b}();_geo.c.hd.ia.dYa=function(){function b(a,b){_geo.c.controls.ia.zt.call(this,a);this.og=b}_geo.c.na(b,_geo.c.controls.ia.zt);b.prototype.Xc=function(){return this.og};return b}();
_geo.c.hd.ia.eYa=function(){function b(a,b){_geo.c.hd.ia.lwa.call(this,{slots:{pointermove:this.oe.bind(this)},name:"string"===typeof b&&""!==b?b:"MD-cursor",layer:a instanceof _geo.c.V.Ya||a instanceof _geo.c.V.Cg?a:null});this.sna=new _geo.c.hd.ia.XIb;this.es({line:{linestyle:(new _geo.c.attributes.za("black",1,[3,2])).Vd({x:!0,y:!0})}});this.$b.Ia(this.sna);this.Mga=null}var a=new _geo.c.f.sa,g=new _geo.c.f.Fa;_geo.c.na(b,_geo.c.hd.ia.lwa);_geo.c.ja(b,"geotoolkit.deviation.tools.MDCursorTool");
b.aa={VL:"onPositionChanged"};b.prototype.cj=function(){var a=this.isEnabled();this.sna.Ma(a);this.$b.ma();_geo.c.hd.ia.lwa.prototype.cj.call(this)};b.prototype.es=function(a){null!=a.enabled&&this.zc(a.enabled);this.sna.es(a);return this};b.prototype.UNc=function(a){this.setActive(!1)};b.prototype.oe=function(e){if(this.isEnabled()){var d=this.eCa();if(d){var f=d.yL();null!=f&&(d=d.Za(),this.qj?this.qj.update(d):this.qj=f.transformer.create(f,d),f=this.mH(e),a.lb(f.x,f.y),f=this.qj.te(a),(0,window.isNaN)(f.ga())||
(0,window.isNaN)(f.ea())?(this.sna.Ma(!1),null!==this.Mga&&(this.Mga=null,this.fireEvent(b.aa.VL,new _geo.c.hd.ia.dYa(e,this.Mga)))):(this.Pdc(f),this.sna.Ma(!0),this.setActive(!0),null!=this.Mga&&_geo.c.f.Math.lh(this.Mga.ea(),f.ea())&&_geo.c.f.Math.lh(this.Mga.ga(),f.ga())||(this.Mga=f,this.fireEvent(b.aa.VL,new _geo.c.hd.ia.dYa(e,this.Mga)))))}}};b.prototype.update=function(){if(this.isEnabled()){var a=this.sna.getData(),b=this.eCa();null!=a&&null!=b&&(this.qj.update(b.Za()),this.Pdc(a))}};b.prototype.Pdc=
function(b){var d=this.eCa().yL();if(d){a.lb(0,b.ea());var f=this.qj.transform(a,g),d=d.trackWidth;a.lb(d,b.ea());var d=this.qj.transform(a,g),h=this.Zc.Za();null!=h&&(f=h.Ie(f),d=h.Ie(d));this.sna.setData(f,d,b)}};return b}();_geo.c.hd.ia.Kea=function(b,a){_geo.c.controls.ia.zt.call(this,b);a=_geo.c.Ja(a,{},!0);void 0!==a.area&&(this.KM=a.area);void 0!==a.startmd&&(this.tpc=a.startmd);void 0!==a.endmd&&(this.anc=a.endmd)};_geo.c.na(_geo.c.hd.ia.Kea,_geo.c.controls.ia.zt);
_geo.c.ja(_geo.c.hd.ia.Kea,"geotoolkit.deviation.tools.MDRubberBandEventArgs");_geo.c.hd.ia.Kea.prototype.M2b=function(){return this.tpc};_geo.c.hd.ia.Kea.prototype.YZb=function(){return this.anc};_geo.c.hd.ia.Kea.prototype.RI=function(){return this.KM};
_geo.c.hd.ia.FIa=function(){function b(b,f){f=f||_geo.c.hd.ia.FIa.b4.WIb;var g;g="md"===f?{pointerdown:this.nCc.bind(this),pointermove:this.pCc.bind(this),pointerup:this.rCc.bind(this)}:{pointerdown:this.oCc.bind(this),pointermove:this.qCc.bind(this),pointerup:this.sCc.bind(this)};_geo.c.hd.ia.lwa.call(this,{slots:g,layer:b,name:"MD-rubberband"});this.zc(!1);this.QW=!0;this.O5=(new _geo.c.V.$.If).Ma(!1).Ba((new _geo.c.attributes.za(e,1,[2,3])).Vd({x:!1,y:!1})).Ea(new _geo.c.attributes.Ha(d));null!=
this.$b&&this.$b.Ia(this.O5);this.iNa=(new _geo.c.V.$.Th(new _geo.c.f.Rect(0,0,0,0))).Ma(!1).Ba((new _geo.c.attributes.za("red",2)).Vd({x:!0,y:!0})).Ea(null);null!=this.$b&&this.$b.Ia(this.iNa);this.sG=null;this.fD=window.NaN;this.wg=0;this.WP=this.fN=window.NaN;this.j4a=new a;this.i4a=new a;this.LMa=new _geo.c.f.Rect}var a=_geo.c.f.sa,g=_geo.c.hd.ia.Kea,e="#bdbdbd",d="rgba(189,189,189,0.5)",f=new a,h=new _geo.c.f.Fa,l=_geo.c.controls.ia.Lr;_geo.c.na(b,_geo.c.hd.ia.lwa);_geo.c.ja(b,"geotoolkit.deviation.tools.MDRubberBand");
b.b4={WIb:"md",Pxa:"xy"};b.prototype.GHc=function(){var a=this.eCa();if(!a)return null;var b=a.yL(),d=a.Za();this.qj?this.qj.update(d):this.qj=b.transformer.create(b,d);this.fD=b.trackWidth;this.wg=b.offset;return a};b.prototype.wob=function(a){var b=this.eCa();if(!b)return f.lb(window.NaN,window.NaN);var d=b.yL(),b=b.Za();this.qj?this.qj.update(b):this.qj=d.transformer.create(d,b);this.fD=d.trackWidth;this.wg=d.offset;a=this.mH(a);f.lb(a.x,a.y);return this.qj.te(f)};b.prototype.nCc=function(a){var b=
this.wob(a);(0,window.isNaN)(b.ga())||(0,window.isNaN)(b.ea())||(a.stopPropagation(!0),this.setActive(!0),this.fN=b.ea(),this.fireEvent(l.aa.mF,new g(a,{startMD:this.fN})))};b.prototype.rCc=function(a){if(this.$e()){var b=this.wob(a);(0,window.isNaN)(b.ga())||(0,window.isNaN)(b.ea())?this.$e()&&(this.setActive(!1),this.O5.Ma(!1).ma()):(a.stopPropagation(!0),this.setActive(!1),this.O5.Ma(!1).ma(),this.fireEvent(l.aa.Vca,new g(a,{startMD:this.fN,endMD:this.WP})),b=new _geo.c.f.Rect(this.$za.ga(),this.$za.ea(),
this.aAa.ga(),this.aAa.ea()),this.fireEvent(l.aa.Ev,new g(a,{area:b})),this.QW&&this.zc(!1))}};b.prototype.n$b=function(){var b=this.Zc.Za(),d=null;b&&(d=b.me());var e=[new a(0,this.fN),new a(this.fD,this.fN),new a(this.fD,this.WP),new a(0,this.WP)],b=[];this.qj.BF(e,b,h,!0);f.lb(this.fD/2-this.wg,this.fN);this.$za=this.qj.transform(f,h);f.lb(this.fD/2-this.wg,this.WP);this.aAa=this.qj.transform(f,h);if(d)for(d.hb(this.$za,this.$za),d.hb(this.aAa,this.aAa),e=0;e<b.length;++e)d.hb(b[e],b[e]);var g=
[],l=[];b.forEach(function(a){g.push(a.ga());l.push(a.ea())});this.O5.hl(g,l)};b.prototype.pCc=function(a){if(this.$e()){var b=this.wob(a);(0,window.isNaN)(b.ga())||(0,window.isNaN)(b.ea())||(a.stopPropagation(!0),this.WP=b.ea(),this.n$b(),this.O5.Ma(!0).ma(),this.fireEvent(l.aa.Vca,new g(a,{startMD:this.fN,endMD:this.WP})))}};b.prototype.oCc=function(a){this.TSb=this.Fe(this.$b,a);var b=this.mH(a);this.j4a.lb(Math.round(b.x),Math.round(b.y));a.stopPropagation(!0);this.setActive(!0);this.GHc()};b.prototype.sCc=
function(a){if(this.$e()&&(a.stopPropagation(!0),this.setActive(!1),this.O5.Ma(!1).ma(),this.iNa.Ma(!1).ma(),!(0,window.isNaN)(this.WP)&&!(0,window.isNaN)(this.fN))){this.fireEvent(l.aa.Vca,new g(a,{startMD:this.fN,endMD:this.WP}));var b=new _geo.c.f.Rect(this.$za.ga(),this.$za.ea(),this.aAa.ga(),this.aAa.ea());this.fireEvent(l.aa.Ev,new g(a,{area:b}));this.QW&&this.zc(!1)}};b.prototype.mka=function(a,b){f.lb(a,b);var d=this.qj.te(f).ea();(0,window.isNaN)(d)||(d<this.fN&&(this.fN=d),d>this.WP&&(this.WP=
d))};b.prototype.Crc=function(){var a=this.eCa();if(a){this.fN=Number.POSITIVE_INFINITY;this.WP=Number.NEGATIVE_INFINITY;for(var b=this.LMa.ta(),a=this.LMa.xa(),d=this.LMa.ua(),e=this.LMa.ya(),f=d;f<e;f+=10)this.mka(f,b),this.mka(f,a);this.mka(e,b);for(this.mka(e,a);b<a;b+=10)this.mka(d,b),this.mka(e,b);this.mka(d,a);this.mka(e,a)}else this.WP=this.fN=window.NaN};b.prototype.qCc=function(a){if(this.$e()){var b=this.mH(a);this.i4a.lb(Math.round(b.x),Math.round(b.y));if(this.i4a.x!==this.j4a.x&&this.i4a.y!==
this.j4a.y){b=function(a,b,d){a.Tb(Math.min(b.x,d.x),Math.min(b.y,d.y),Math.max(b.x,d.x),Math.max(b.y,d.y))};b(this.LMa,this.j4a,this.i4a);var d=this.Fe(this.$b,a);!1===this.iNa.ob()&&this.TSb.MI(d)||(this.hqc=d,b(this.iNa,this.TSb,this.hqc),this.iNa.Ma(!0).ma(),this.Crc(),(0,window.isNaN)(this.WP)||(0,window.isNaN)(this.fN)?this.O5.Ma(!1).ma():(this.n$b(),this.O5.Ma(!0).ma()),a.stopPropagation(!0),this.fireEvent(l.aa.Vca,new g(a,{startMD:this.fN,endMD:this.WP})))}}};b.prototype.bb=function(a){null!=
a.enabled&&this.zc(a.enabled);void 0!==a.linestyle&&this.O5.Ba(a.linestyle);void 0!==a.fillstyle&&this.O5.Ea(a.fillstyle);null!=a.autodisabled&&(this.QW=a.autodisabled);return this};return b}();
(function(){var b="geotoolkit",a="Transformation",g="scene",e="Events",d="renderer",f="tools",h=_geo.c.hx,l=_geo.c.gx,k=null,m=null;h(b+".deviation.LabelPosition",_geo.c.hd.uk);h(b+".deviation.LabelPosition.Left",(m=_geo.c.hd.uk).De);h(b+".deviation.LabelPosition.Center",m.ub);h(b+".deviation.LabelPosition.Right",m.Pd);h(b+".deviation.Deviated"+a+"",(m=_geo.c.hd).kwa);l(k=_geo.c.hd.kwa.prototype,"update",k.update,{update:0});l(k,"transform",k.transform,{transform:0});l(k,"inverseTransform",k.te,{te:0});
l(k,"transformLine",k.uZ,{uZ:0});l(k,"transformLines",k.BF,{BF:0});l(k,"findBounds",k.sra,{sra:0});l(k,"contains",k.contains,{contains:0});l(k,"scaleXAt",k.u8,{u8:0});l(k,"scaleYAt",k.w8,{w8:0});l(k,"bitmapScaleY",k.iUb,{iUb:0});l(k,"getScalesInfo",k.Gub,{Gub:0});h(b+".deviation.Transformer2d",m.Ixa);l(k=_geo.c.hd.Ixa.prototype,"create",k.create,{create:0});l(k=_geo.c.hd.SLb.prototype,"update",k.update,{update:0});l(k,"transform",k.transform,{transform:0});l(k,"inverseTransform",k.te,{te:0});l(k,
"transformLine",k.uZ,{uZ:0});l(k,"transformLines",k.BF,{BF:0});l(k,"findBounds",k.sra,{sra:0});l(k,"contains",k.contains,{contains:0});l(k,"scaleXAt",k.u8,{u8:0});l(k,"scaleYAt",k.w8,{w8:0});l(k,"maxScaleX",k.JU,{JU:0});l(k,"maxScaleY",k.KU,{KU:0});l(k,"minScaleX",k.nR,{nR:0});l(k,"minScaleY",k.oR,{oR:0});l(k,"digitize",k.$0,{$0:0});h(b+".deviation.TVDTransformer",m.TLb);l(k=_geo.c.hd.TLb.prototype,"getOptions",k.xb,{xb:0});l(k,"setOptions",k.bb,{bb:0});l(k,"create",k.create,{create:0});h(b+".deviation.PiecewiseTransformer",
m.qgb);l(k=_geo.c.hd.qgb.prototype,"getOptions",k.xb,{xb:0});l(k,"setOptions",k.bb,{bb:0});l(k,"create",k.create,{create:0});h(b+".deviation.Trajectory2d",m.thb);l(k=_geo.c.hd.thb.prototype,"getX",k.ga,{ga:0});l(k,"getY",k.ea,{ea:0});l(k,"getDepth",k.Lc,{Lc:0});l(k,"count",k.count,{count:0});l(k,"minDepth",k.mj,{mj:0});l(k,"maxDepth",k.bj,{bj:0});h(b+".deviation.Trajectory2d.createTrajectory",_geo.c.hd.thb.qtc);l(k,"getMinX",k.Qtb,{Qtb:0});l(k,"getMinY",k.Rtb,{Rtb:0});l(k,"getMaxX",k.Ltb,{Ltb:0});
l(k,"getMaxY",k.Mtb,{Mtb:0});h(b+"."+g+".DeviatedCompositeNode",_geo.c.V.jma);h(b+"."+g+".DeviatedCompositeNode."+e+"",_geo.c.V.jma.aa);h(b+"."+g+".DeviatedCompositeNode."+e+".DeviationChanged",_geo.c.V.jma.aa.Ceb);l(k=_geo.c.V.jma.prototype,"addListener",k.addListener,{addListener:0});l(k,"removeListener",k.removeListener,{removeListener:0});l(k,"onDeviationChanged",k.Axb,{Axb:0});l(k,"setDeviation",k.Mua,{Mua:0});l(k,"getDeviation",k.yL,{yL:0});l(k,"getModelLimits",k.va,{va:0});l(k,"getBounds",
k.ha,{ha:0});l(k,"setBounds",k.Ga,{Ga:0});l(k,"getTrajectoryLimits",k.Y8a,{Y8a:0});l(k,"updateState",k.Qa,{Qa:0});l(k,"getContentsTransform",k.ae,{ae:0});l(k,"invalidateParent",k.xi,{xi:0});l(k,"checkCollision",k.Ff,{Ff:0});l(k,"render",k.Aa,{Aa:0});l(k,"findDepthRange",k.SXb,{SXb:0});l(k=_geo.c.Sa.kma.prototype,"setDeviation",k.Mua,{Mua:0});l(k,"getInfo",k.F7a,{F7a:0});l(k,"update",k.update,{update:0});l(k,"updateTransformation",k.qdb,{qdb:0});l(k,"pushTransformation",k.Qc,{Qc:0});l(k,"getTransformation",
k.$a,{$a:0});l(k,"setTransformation",k.sc,{sc:0});l(k,"getInverseTransformation",k.rq,{rq:0});l(k,"getLocalTransformation",k.mx,{mx:0});l(k,"drawRectangle",k.xc,{xc:0});l(k,"drawPolygon",k.Kk,{Kk:0});l(k,"drawPolyline",k.Fm,{Fm:0});l(k,"drawLine",k.Id,{Id:0});l(k,"drawEllipse",k.xn,{xn:0});l(k,"drawArc",k.cp,{cp:0});l(k,"drawAnnulusArc",k.sv,{sv:0});l(k,"drawImage",k.drawImage,{drawImage:0});l(k,"drawText",k.be,{be:0});l(k,"beginPath",k.beginPath,{beginPath:0});l(k,"moveTo",k.moveTo,{moveTo:0});l(k,
"lineTo",k.lineTo,{lineTo:0});l(k,"arcTo",k.arcTo,{arcTo:0});l(k,"bezierCurveTo",k.bezierCurveTo,{bezierCurveTo:0});l(k,"stroke",k.stroke,{stroke:0});l(k,"closePath",k.closePath,{closePath:0});l(k,"fillPath",k.Wh,{Wh:0});l(k,"setTextStyle",k.Ob,{Ob:0});l(k,"getParent",k.getParent,{getParent:0});l(k,"getContext2d",k.pk,{pk:0});l(k,"createRenderingState",k.ky,{ky:0});l(k,"createSurface",k.lw,{lw:0});l(k,"setDeviceRect",k.Bw,{Bw:0});l(k,"setModelRect",k.Ry,{Ry:0});l(k,"getDeviceRect",k.Ye,{Ye:0});l(k,
"getModelRect",k.zk,{zk:0});l(k,"setClip",k.Ji,{Ji:0});l(k,"isPicking",k.Sd,{Sd:0});l(k,"measureText",k.measureText,{measureText:0});l(k,"save",k.save,{save:0});l(k,"restore",k.restore,{restore:0});l(k,"findLinearBbox",k.q6a,{q6a:0});l(k,"setCurrentNode",k.Mm,{Mm:0});l(k,"beginRendering",k.AI,{AI:0});l(k,"endRendering",k.LI,{LI:0});l(k,"setFillPattern",k.ro,{ro:0});l(k,"setFillStyle",k.Ea,{Ea:0});l(k,"getFillStyle",k.Bb,{Bb:0});l(k,"setLineStyle",k.Ba,{Ba:0});h(b+"."+d+".DeviatedSurface",_geo.c.Sa.Beb);
l(k=_geo.c.Sa.Beb.prototype,"render",k.Aa,{Aa:0});h(b+".deviation."+f+".DeviationTool",(m=_geo.c.hd.ia).lwa);l(k=_geo.c.hd.ia.XIb.prototype,"invalidate",k.ma,{ma:0});h(b+".deviation."+f+".MDCursorEventArgs",m.dYa);l(k=_geo.c.hd.ia.dYa.prototype,"getPosition",k.Xc,{Xc:0});h(b+".deviation."+f+".MDCursorTool",m.eYa);h(b+".deviation."+f+".MDCursorTool."+e+"",_geo.c.hd.ia.eYa.aa);h(b+".deviation."+f+".MDCursorTool."+e+".onPositionChanged",_geo.c.hd.ia.eYa.aa.VL);l(k=_geo.c.hd.ia.eYa.prototype,"onActiveStateChanged",
k.cj,{cj:0});l(k,"setSettings",k.es,{es:0});l(k,"update",k.update,{update:0});h(b+".deviation."+f+".MDRubberBandEventArgs",(m=_geo.c.hd.ia).Kea);l(k=_geo.c.hd.ia.Kea.prototype,"getStartMD",k.M2b,{M2b:0});l(k,"getEndMD",k.YZb,{YZb:0});l(k,"getArea",k.RI,{RI:0});h(b+".deviation."+f+".MDRubberBand",m.FIa);h(b+".deviation."+f+".MDRubberBand.Mode",_geo.c.hd.ia.FIa.b4);h(b+".deviation."+f+".MDRubberBand.Mode.MD",(m=_geo.c.hd.ia.FIa.b4).WIb);h(b+".deviation."+f+".MDRubberBand.Mode.XY",m.Pxa);l(k=_geo.c.hd.ia.FIa.prototype,
"setOptions",k.bb,{bb:0})})();

    return _geo;
}));
/* eslint-enable */
/* tslint:enable */